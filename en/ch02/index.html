<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2. Get Started &mdash; Qt5 Cadaques Book v2015-03</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.2.0/sandstone/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2015-03',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Qt5 Cadaques Book v2015-03" href="../../index.html" />
    <link rel="next" title="3. Qt Creator IDE" href="../ch03/index.html" />
    <link rel="prev" title="1. Meet Qt 5" href="../ch01/index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          QmlBook</a>
        <span class="navbar-text navbar-version pull-left"><b>2015-03</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Chapters <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ch01/index.html">1. Meet Qt 5</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">2. Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch03/index.html">3. Qt Creator IDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch04/index.html">4. Quick Starter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch05/index.html">5. Fluid Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch06/index.html">6. Model-View-Delegate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch07/index.html">7. Canvas Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch08/index.html">8. Particle Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch09/index.html">9. Shader Effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch10/index.html">10. Multimedia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch11/index.html">11. Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch12/index.html">12. Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch13/index.html">13. Dynamic QML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch14/index.html">14. JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch15/index.html">15. Qt and C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch16/index.html">16. Extending QML with C++</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">2. Get Started</a><ul>
<li><a class="reference internal" href="#installing-qt-5-sdk">2.1. Installing Qt 5 SDK</a></li>
<li><a class="reference internal" href="#hello-world">2.2. Hello World</a></li>
<li><a class="reference internal" href="#application-types">2.3. Application Types</a><ul>
<li><a class="reference internal" href="#console-application">2.3.1. Console Application</a></li>
<li><a class="reference internal" href="#widget-application">2.3.2. Widget Application</a></li>
<li><a class="reference internal" href="#adapting-data">2.3.3. Adapting Data</a></li>
<li><a class="reference internal" href="#qt-quick-application">2.3.4. Qt Quick Application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary">2.4. Summary</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../ch01/index.html" title="Previous Chapter: 1. Meet Qt 5"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 1. Meet Qt 5</span>
    </a>
  </li>
  <li>
    <a href="../ch03/index.html" title="Next Chapter: 3. Qt Creator IDE"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">3. Qt Creator ID... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">2. Get Started</a><ul>
<li><a class="reference internal" href="#installing-qt-5-sdk">2.1. Installing Qt 5 SDK</a></li>
<li><a class="reference internal" href="#hello-world">2.2. Hello World</a></li>
<li><a class="reference internal" href="#application-types">2.3. Application Types</a><ul>
<li><a class="reference internal" href="#console-application">2.3.1. Console Application</a></li>
<li><a class="reference internal" href="#widget-application">2.3.2. Widget Application</a></li>
<li><a class="reference internal" href="#adapting-data">2.3.3. Adapting Data</a></li>
<li><a class="reference internal" href="#qt-quick-application">2.3.4. Qt Quick Application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary">2.4. Summary</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9">
      
  <div class="section" id="get-started">
<h1>2. Get Started<a class="headerlink" href="#get-started" title="Permalink to this headline">¶</a></h1>
<p><em>Section author: <a class="reference external" href="https://github.com/jryannel">jryannel</a></em></p>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch02%2Findex.html%23get-started&labels=ch02">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch02&page=1&state=open">View</a></div><p>This chapter will introduce you to developing with Qt 5. We will show you how to install the Qt SDK and how you can create as well as run a simple <em>hello world</em> application using the Qt Creator IDE.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The source code of this chapter can be found in the <a class="reference external" href="../assets">assets folder</a>.</p>
</div>
<div class="section" id="installing-qt-5-sdk">
<h2>2.1. Installing Qt 5 SDK<a class="headerlink" href="#installing-qt-5-sdk" title="Permalink to this headline">¶</a></h2>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch02%2Findex.html%23installing-qt-5-sdk&labels=ch02">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch02&page=1&state=open">View</a></div><p>The Qt SDK include the tools needed to build desktop or embedded applications. The latest version can be grabbed from the <a class="reference external" href="http://qt-project.org">Qt-Project homepage</a>. . This is the recommended way to start. The SDK itself has a maintenance tool which will allow you to update the SDK to the latest version.</p>
<p>The Qt SDK is easy to install and comes with its own IDE for rapid development called <em>Qt Creator</em>. The IDE is a highly productive environment for Qt coding and recommended to all readers. For any circumstances Qt can be used from the command line and you are free to use a code editor of your choice.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">&#8220;the Qt SDK&#8221; or simply &#8220;Qt SDK&#8221;</p>
</div>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">&#8220;For any circumstances&#8221;</p>
</div>
<p>When installing the SDK, you should select the default option and ensure that Qt 5.x is enabled. Then you are ready to go.</p>
</div>
<div class="section" id="hello-world">
<h2>2.2. Hello World<a class="headerlink" href="#hello-world" title="Permalink to this headline">¶</a></h2>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch02%2Findex.html%23hello-world&labels=ch02">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch02&page=1&state=open">View</a></div><p>To test your installation, we will create a small <em>hello world</em> application. Please open Qt Creator and create a Qt Quick UI Project ( <span class="menuselection">File ‣ New File or Project ‣ Qt Quick Project ‣ Qt Quick UI</span> ) and name the project <code class="docutils literal"><span class="pre">HelloWorld</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Qt Creator IDE allows you to create various types of applications. If not otherwise stated, we always use a <span class="guilabeL">Qt Quick UI</span> project.</p>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">A typical Qt Quick application is made out of a runtime as well as either native plug-ins or native code which launches the runtime code. For the beginning we will not cover the native side of development and focus only of the runtime aspects of Qt5.</p>
</div>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p class="last">can native plug-ins launch the runtime code?</p>
</div>
<p>Qt Creator will create several files for you. The <code class="docutils literal"><span class="pre">HelloWorld.qmlproject</span></code> file is the project file where the relevant project configuration is stored. This file is managed by Qt Creator so don&#8217;t edit.</p>
<p>Another file, <code class="docutils literal"><span class="pre">HelloWorld.qml</span></code>, is our application code. Open it and try to guess what the application does and then continue to read-on.</p>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<p class="last">&#8220;read-on&#8221;</p>
</div>
<div class="highlight-js"><div class="highlight"><pre><span class="c1">// HelloWorld.qml</span>

<span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>

<span class="nx">Rectangle</span> <span class="p">{</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mi">360</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">360</span>
    <span class="nx">Text</span> <span class="p">{</span>
        <span class="nx">anchors</span><span class="p">.</span><span class="nx">centerIn</span><span class="o">:</span> <span class="nx">parent</span>
        <span class="nx">text</span><span class="o">:</span> <span class="s2">&quot;Hello World&quot;</span>
    <span class="p">}</span>
    <span class="nx">MouseArea</span> <span class="p">{</span>
        <span class="nx">anchors</span><span class="p">.</span><span class="nx">fill</span><span class="o">:</span> <span class="nx">parent</span>
        <span class="nx">onClicked</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">Qt</span><span class="p">.</span><span class="nx">quit</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">HelloWord.qml</span></code> is written in the QML language. We will discuss the QML language in more depth in the next chapter, just so much it&#8217;s describes the user interface in a series of hierarchical elements. This code in particular show a rectangle of 360 x 360 pixel geometry with a centered text &#8220;Hello World&#8221;. A mouse area spans the whole rectangle and when the user clicks it, the application quits.</p>
<div class="admonition-todo admonition" id="index-4">
<p class="first admonition-title">Todo</p>
<p class="last">&#8220;just so much it&#8217;s describes the user interface in a series of hierarchical elements&#8221;</p>
</div>
<p>To run the application on your own, please press the <img alt="creatorrun" src="../../_images/qtcreator-run.png" /> <span class="guilabel">Run</span> tool on the left side or select <span class="menuselection">Build ‣ Run</span> from the menu.</p>
<p>If everything goes well you should see now something like this:</p>
<div class="admonition-todo admonition" id="index-5">
<p class="first admonition-title">Todo</p>
<p class="last">&#8220;If everything goes well&#8221;</p>
</div>
<a class="reference internal image-reference" href="../../_images/example.png"><img alt="../../_images/example.png" src="../../_images/example.png" style="width: 220.0px; height: 231.0px;" /></a>
<p>Qt 5 seems to be working and we are ready to continue.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If you are a system integrator, you&#8217;ll want to have Qt SDK installed to get the latest stable Qt release as well as a Qt version compiled from source code for your specific device target.</p>
</div>
<div class="topic">
<p class="topic-title first">Build from Scratch</p>
<p>If you&#8217;d like to build Qt5 from the command line, you&#8217;ll first need to grab a copy of the code repository and build it.</p>
<div class="highlight-sh"><div class="highlight"><pre>git clone git://gitorious.org/qt/qt5.git
<span class="nb">cd </span>qt5
./init-repository
./configure -prefix <span class="nv">$PWD</span>/qtbase -opensource
make -j4
</pre></div>
</div>
<p>After a successful compilation and 2 cups of coffee, Qt 5 will be available in the <code class="docutils literal"><span class="pre">qtbase</span></code> folder. Any beverage will suffice, however, we suggest coffee for best results.</p>
<p>If you want to test your compilation, simply start <code class="docutils literal"><span class="pre">qtbase/bin/qmlscene</span></code> and select a QtQuick example to run it ...or follow just us into the next chapter.</p>
<p>To test your installation, we will create a small hello world application. Please create a simple <code class="docutils literal"><span class="pre">example.qml</span></code> file using your favorite text editor and paste the following content inside:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="c1">// HelloWorld.qml</span>

<span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>

<span class="nx">Rectangle</span> <span class="p">{</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mi">360</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">360</span>
    <span class="nx">Text</span> <span class="p">{</span>
        <span class="nx">anchors</span><span class="p">.</span><span class="nx">centerIn</span><span class="o">:</span> <span class="nx">parent</span>
        <span class="nx">text</span><span class="o">:</span> <span class="s2">&quot;Greetings from Qt5&quot;</span>
    <span class="p">}</span>
    <span class="nx">MouseArea</span> <span class="p">{</span>
        <span class="nx">anchors</span><span class="p">.</span><span class="nx">fill</span><span class="o">:</span> <span class="nx">parent</span>
        <span class="nx">onClicked</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">Qt</span><span class="p">.</span><span class="nx">quit</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can run now the example by using the default runtime which comes with Qt 5:</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="nx">$</span> <span class="nx">qtbase</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">qmlscene</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="application-types">
<h2>2.3. Application Types<a class="headerlink" href="#application-types" title="Permalink to this headline">¶</a></h2>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch02%2Findex.html%23application-types&labels=ch02">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch02&page=1&state=open">View</a></div><p>This section is a run through the different types of possible application types someone could write with Qt5. It&#8217;s not limited to the presented selection but it should give the reader a better idea about what could be done with Qt5 in general.</p>
<div class="section" id="console-application">
<h3>2.3.1. Console Application<a class="headerlink" href="#console-application" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch02%2Findex.html%23console-application&labels=ch02">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch02&page=1&state=open">View</a></div><p>A console application does not provide any graphical HMI and will normally be called as part of a system service or from the command line. Qt5 comes with a series of ready made components which help you to create console applications cross platform and very efficient. For example networking API or file API. Also string handling or since Qt 5.1 efficient command line parser. As Qt is a high-level API on top of C++ you get programming speed paired with execution speed. Don&#8217;t think as Qt being <em>just</em> as UI toolkit it has so much more to offer.</p>
<p class="rubric">String Handling</p>
<p>In the fist example we demonstrate how someone could very simple add 2 constant strings. This is not a very useful application but gives you the idea how a native C++ application without an event loop could look like.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="c1">// module or class includes</span>
<span class="cp">#include &lt;QtCore&gt;</span>

<span class="c1">// text stream is text-codec aware</span>
<span class="n">QTextStream</span> <span class="nf">cout</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="n">QIODevice</span><span class="o">::</span><span class="n">WriteOnly</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// avoid compiler warnings</span>
    <span class="n">Q_UNUSED</span><span class="p">(</span><span class="n">argc</span><span class="p">)</span>
    <span class="n">Q_UNUSED</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">QString</span> <span class="n">s1</span><span class="p">(</span><span class="s">&quot;Paris&quot;</span><span class="p">);</span>
    <span class="n">QString</span> <span class="n">s2</span><span class="p">(</span><span class="s">&quot;London&quot;</span><span class="p">);</span>
    <span class="c1">// string concatenation</span>
    <span class="n">QString</span> <span class="n">s</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">s2</span> <span class="o">+</span> <span class="s">&quot;!&quot;</span><span class="p">;</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="rubric">Container Classes</p>
<p>This example adds a lists and list iteration to the application. Qt comes with a large collections of container classes which are easy to use and use the same API paradigms then the rest of Qt classes.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">QString</span> <span class="nf">s1</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">);</span>
<span class="n">QString</span> <span class="nf">s2</span><span class="p">(</span><span class="s">&quot;Qt&quot;</span><span class="p">);</span>
<span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;</span> <span class="n">list</span><span class="p">;</span>
<span class="c1">// stream into containers</span>
<span class="n">list</span> <span class="o">&lt;&lt;</span>  <span class="n">s1</span> <span class="o">&lt;&lt;</span> <span class="n">s2</span><span class="p">;</span>
<span class="c1">// Java and STL like iterators</span>
<span class="n">QListIterator</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;</span> <span class="n">iter</span><span class="p">(</span><span class="n">list</span><span class="p">);</span>
<span class="k">while</span><span class="p">(</span><span class="n">iter</span><span class="p">.</span><span class="n">hasNext</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">iter</span><span class="p">.</span><span class="n">next</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">iter</span><span class="p">.</span><span class="n">hasNext</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;!&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>Here we show some advanced list function, which allow you to join a list of strings into one string. This is very handy when you need to proceed line based text input. The inverse (string to string-list) is also possible using <code class="docutils literal"><span class="pre">QString::split()</span></code> function.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">QString</span> <span class="nf">s1</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">);</span>
<span class="n">QString</span> <span class="nf">s2</span><span class="p">(</span><span class="s">&quot;Qt&quot;</span><span class="p">);</span>
<span class="c1">// convenient container classes</span>
<span class="n">QStringList</span> <span class="n">list</span><span class="p">;</span>
<span class="n">list</span> <span class="o">&lt;&lt;</span>  <span class="n">s1</span> <span class="o">&lt;&lt;</span> <span class="n">s2</span><span class="p">;</span>
<span class="c1">// join strings</span>
<span class="n">QString</span> <span class="n">s</span> <span class="o">=</span> <span class="n">list</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;!&quot;</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p class="rubric">File IO</p>
<p>In the next snippet we read a CSV file from the local directory and loop over the rows to extract the cells from each row. By this we get the table data from the CSV file in ca. 20 lines of code. File reading gives us just a byte stream, to be able to convert it into a valid Unicode text we need to use the text stream and pass in the file as a lower-level stream. For writing CSV files you would just need to open the file in the write mode and pipe the lines into the text stream.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">QList</span><span class="o">&lt;</span><span class="n">QStringList</span><span class="o">&gt;</span> <span class="n">data</span><span class="p">;</span>
<span class="c1">// file operations</span>
<span class="n">QFile</span> <span class="nf">file</span><span class="p">(</span><span class="s">&quot;sample.csv&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="n">file</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">QIODevice</span><span class="o">::</span><span class="n">ReadOnly</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">QTextStream</span> <span class="n">stream</span><span class="p">(</span><span class="o">&amp;</span><span class="n">file</span><span class="p">);</span>
    <span class="c1">// loop forever macro</span>
    <span class="n">forever</span> <span class="p">{</span>
        <span class="n">QString</span> <span class="n">line</span> <span class="o">=</span> <span class="n">stream</span><span class="p">.</span><span class="n">readLine</span><span class="p">();</span>
        <span class="c1">// test for null string &#39;String()&#39;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">isNull</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">// test for empty string &#39;QString(&quot;&quot;)&#39;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">QStringList</span> <span class="n">row</span><span class="p">;</span>
        <span class="c1">// for each loop to iterate over containers</span>
        <span class="n">foreach</span><span class="p">(</span><span class="k">const</span> <span class="n">QString</span><span class="o">&amp;</span> <span class="n">cell</span><span class="p">,</span> <span class="n">line</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">row</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="p">.</span><span class="n">trimmed</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="n">data</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// No cleanup necessary.</span>
</pre></div>
</div>
<p>This closes our section about console based application with Qt.</p>
</div>
<div class="section" id="widget-application">
<h3>2.3.2. Widget Application<a class="headerlink" href="#widget-application" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch02%2Findex.html%23widget-application&labels=ch02">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch02&page=1&state=open">View</a></div><p>Console based applications are very handy but sometimes you need to have some UI to show. But also UI based applications will need some back-end to read/write files, communicate over the network or keep data in a container.</p>
<p>In the first snippet for widget based applications we do as little as creating a window and show it. A widget without a parent is in the Qt world a window. We use the scope pointer to ensure the widget is deleted when the scoped pointer goes out of scope. The application object encapsulate the qt runtime and with the exec call we start the event loop. From there on the application re-acts only on events triggered by mouse or keyboard or other event providers like networking or file IO. The application will only exits when the event loop is exited, this is done by call &#8216;quit()&#8217; on the application or by closing the window.</p>
<p>When you run the code you will see a window with the size of 240 x 120 pixel. That&#8217;s all.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &lt;QtGui&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QApplication</span> <span class="n">app</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
    <span class="n">QScopedPointer</span><span class="o">&lt;</span><span class="n">QWidget</span><span class="o">&gt;</span> <span class="n">widget</span><span class="p">(</span><span class="k">new</span> <span class="n">CustomWidget</span><span class="p">());</span>
    <span class="n">widget</span><span class="o">-&gt;</span><span class="n">resize</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">120</span><span class="p">);</span>
    <span class="n">widget</span><span class="o">-&gt;</span><span class="n">show</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">app</span><span class="p">.</span><span class="n">exec</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="rubric">Custom Widgets</p>
<p>When you work on user interfaces of you need to create custom made widgets. Typically a widget is a window area filled with painting calls. Additional the widget has internal knowledge how to handle keyboard or mouse input of how to react on external triggers. To do this in Qt we need to derive from QWidget and overwrite several functions for painting and event handling.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#ifndef CUSTOMWIDGET_H</span>
<span class="cp">#define CUSTOMWIDGET_H</span>

<span class="cp">#include &lt;QtWidgets&gt;</span>

<span class="k">class</span> <span class="nc">CustomWidget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">CustomWidget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">mouseMoveEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>
<span class="k">private</span><span class="o">:</span>
    <span class="n">QPoint</span> <span class="n">m_lastPos</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">// CUSTOMWIDGET_H</span>
</pre></div>
</div>
<p>In the implementation we draw a small border on our widget and a small rectangle on the last mouse position. This is very typical for a low-level custom widget. Mouse or keyboard events change the internal state of the widget and trigger a painting update. We don&#8217;t want to go into to much detail into this code, good to know that you have the possibilities. Qt comes with a large set of ready made desktop widgets, so that the probability is high that you don&#8217;t have to do this.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &quot;customwidget.h&quot;</span>

<span class="n">CustomWidget</span><span class="o">::</span><span class="n">CustomWidget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">CustomWidget</span><span class="o">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QPainter</span> <span class="n">painter</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">QRect</span> <span class="n">r1</span> <span class="o">=</span> <span class="n">rect</span><span class="p">().</span><span class="n">adjusted</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">);</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s">&quot;#33B5E5&quot;</span><span class="p">));</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="n">r1</span><span class="p">);</span>

    <span class="n">QRect</span> <span class="nf">r2</span><span class="p">(</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">QSize</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">));</span>
    <span class="k">if</span><span class="p">(</span><span class="n">m_lastPos</span><span class="p">.</span><span class="n">isNull</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">r2</span><span class="p">.</span><span class="n">moveCenter</span><span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">center</span><span class="p">());</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">r2</span><span class="p">.</span><span class="n">moveCenter</span><span class="p">(</span><span class="n">m_lastPos</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">painter</span><span class="p">.</span><span class="n">fillRect</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">QColor</span><span class="p">(</span><span class="s">&quot;#FFBB33&quot;</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">CustomWidget</span><span class="o">::</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_lastPos</span> <span class="o">=</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">pos</span><span class="p">();</span>
    <span class="n">update</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">CustomWidget</span><span class="o">::</span><span class="n">mouseMoveEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_lastPos</span> <span class="o">=</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">pos</span><span class="p">();</span>
    <span class="n">update</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="rubric">Desktop Widgets</p>
<p>The Qt developers have done all of this for you already and provide a set of desktop widgets, which will look native an the different systems. Your job is then to arrange these different widgets in a widget container to larger panels. A widget in Qt can also be a container for other widgets. This is accomplished by the parent-child relationship. This mean we need to make our ready made widgets like buttons, check boxes, radio button but also lists and grids a child of another widget. One way to accomplish this is displayed below.</p>
<p>Here is the header file for a so called widget container.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="k">class</span> <span class="nc">CustomWidget</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">CustomWidgetQWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">private</span> <span class="nl">slots</span><span class="p">:</span>
    <span class="kt">void</span> <span class="n">itemClicked</span><span class="p">(</span><span class="n">QListWidgetItem</span><span class="o">*</span> <span class="n">item</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">updateItem</span><span class="p">();</span>
<span class="k">private</span><span class="o">:</span>
    <span class="n">QListWidget</span> <span class="o">*</span><span class="n">m_widget</span><span class="p">;</span>
    <span class="n">QLineEdit</span> <span class="o">*</span><span class="n">m_edit</span><span class="p">;</span>
    <span class="n">QPushButton</span> <span class="o">*</span><span class="n">m_button</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>In the implementation we use layouts to better arrange our widgets. They re-layout the widgets according to some size policies when the container widget is re-sized. In this example we have a list, line edit and button arranged vertically to allow to edit a list of cities. We use Qts signal and slots to connect sender and receiver objects.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">CustomWidget</span><span class="o">::</span><span class="n">CustomWidget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QVBoxLayout</span> <span class="o">*</span><span class="n">layout</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">m_widget</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QListWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">layout</span><span class="o">-&gt;</span><span class="n">addWidget</span><span class="p">(</span><span class="n">m_widget</span><span class="p">);</span>

    <span class="n">m_edit</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">layout</span><span class="o">-&gt;</span><span class="n">addWidget</span><span class="p">(</span><span class="n">m_edit</span><span class="p">);</span>

    <span class="n">m_button</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s">&quot;Quit&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="n">layout</span><span class="o">-&gt;</span><span class="n">addWidget</span><span class="p">(</span><span class="n">m_button</span><span class="p">);</span>
    <span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">);</span>

    <span class="n">QStringList</span> <span class="n">cities</span><span class="p">;</span>
    <span class="n">cities</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Paris&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;London&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Munich&quot;</span><span class="p">;</span>
    <span class="n">foreach</span><span class="p">(</span><span class="k">const</span> <span class="n">QString</span><span class="o">&amp;</span> <span class="n">city</span><span class="p">,</span> <span class="n">cities</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m_widget</span><span class="o">-&gt;</span><span class="n">addItem</span><span class="p">(</span><span class="n">city</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">connect</span><span class="p">(</span><span class="n">m_widget</span><span class="p">,</span> <span class="n">SIGNAL</span><span class="p">(</span><span class="n">itemClicked</span><span class="p">(</span><span class="n">QListWidgetItem</span><span class="o">*</span><span class="p">)),</span> <span class="k">this</span><span class="p">,</span> <span class="n">SLOT</span><span class="p">(</span><span class="n">itemClicked</span><span class="p">(</span><span class="n">QListWidgetItem</span><span class="o">*</span><span class="p">)));</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">m_edit</span><span class="p">,</span> <span class="n">SIGNAL</span><span class="p">(</span><span class="n">editingFinished</span><span class="p">()),</span> <span class="k">this</span><span class="p">,</span> <span class="n">SLOT</span><span class="p">(</span><span class="n">updateItem</span><span class="p">()));</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">m_button</span><span class="p">,</span> <span class="n">SIGNAL</span><span class="p">(</span><span class="n">clicked</span><span class="p">()),</span> <span class="n">qApp</span><span class="p">,</span> <span class="n">SLOT</span><span class="p">(</span><span class="n">quit</span><span class="p">()));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">CustomWidget</span><span class="o">::</span><span class="n">itemClicked</span><span class="p">(</span><span class="n">QListWidgetItem</span> <span class="o">*</span><span class="n">item</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Q_ASSERT</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
    <span class="n">m_edit</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">CustomWidget</span><span class="o">::</span><span class="n">updateItem</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">QListWidgetItem</span><span class="o">*</span> <span class="n">item</span> <span class="o">=</span> <span class="n">m_widget</span><span class="o">-&gt;</span><span class="n">currentItem</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">item</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="n">m_edit</span><span class="o">-&gt;</span><span class="n">text</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="rubric">Drawing Shapes</p>
<p>Some problems are better visualized. If the problem at hand looks faintly like geometrical objects, qt graphics view is a good candidate. A graphics view arranges simple geometrical shapes on a scene. the user can interact with these shapes or they are positioned using an algorithm. To populate a graphics view you need a graphics view and a graphics scene. The scene is attached to the view and populates with graphics items.
Here a short example. First the header file with the declaration of the view and scene.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="k">class</span> <span class="nc">CustomWidgetV2</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">CustomWidgetV2</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">private</span><span class="o">:</span>
    <span class="n">QGraphicsView</span> <span class="o">*</span><span class="n">m_view</span><span class="p">;</span>
    <span class="n">QGraphicsScene</span> <span class="o">*</span><span class="n">m_scene</span><span class="p">;</span>

<span class="p">};</span>
</pre></div>
</div>
<p>In the implementation the scene gets attached to the view first. The view is a widget and get arranged in our container widget. At the end we add a small rectangle to the scene, which then is rendered on the view.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &quot;customwidgetv2.h&quot;</span>

<span class="n">CustomWidget</span><span class="o">::</span><span class="n">CustomWidget</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_view</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QGraphicsView</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">m_scene</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QGraphicsScene</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">m_view</span><span class="o">-&gt;</span><span class="n">setScene</span><span class="p">(</span><span class="n">m_scene</span><span class="p">);</span>

    <span class="n">QVBoxLayout</span> <span class="o">*</span><span class="n">layout</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">layout</span><span class="o">-&gt;</span><span class="n">setMargin</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">layout</span><span class="o">-&gt;</span><span class="n">addWidget</span><span class="p">(</span><span class="n">m_view</span><span class="p">);</span>
    <span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">);</span>

    <span class="n">QGraphicsItem</span><span class="o">*</span> <span class="n">rect1</span> <span class="o">=</span> <span class="n">m_scene</span><span class="o">-&gt;</span><span class="n">addRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">NoPen</span><span class="p">,</span> <span class="n">QColor</span><span class="p">(</span><span class="s">&quot;#FFBB33&quot;</span><span class="p">));</span>
    <span class="n">rect1</span><span class="o">-&gt;</span><span class="n">setFlags</span><span class="p">(</span><span class="n">QGraphicsItem</span><span class="o">::</span><span class="n">ItemIsFocusable</span><span class="o">|</span><span class="n">QGraphicsItem</span><span class="o">::</span><span class="n">ItemIsMovable</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="adapting-data">
<h3>2.3.3. Adapting Data<a class="headerlink" href="#adapting-data" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch02%2Findex.html%23adapting-data&labels=ch02">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch02&page=1&state=open">View</a></div><p>Till now we have mostly covered basic data types and how to use widgets and graphic views. Often in your application you will need larger amount of structured data, which also has to be persistently stored. The data also needs to be displayed. For this Qt uses the models. A simple model is the string list model, which gets filled with strings and then attached to a list view.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">m_view</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QListView</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="n">m_model</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QStringListModel</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="n">view</span><span class="o">-&gt;</span><span class="n">setModel</span><span class="p">(</span><span class="n">m_model</span><span class="p">);</span>

<span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;</span> <span class="n">cities</span><span class="p">;</span>
<span class="n">cities</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Munich&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Paris&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;London&quot;</span><span class="p">;</span>
<span class="n">model</span><span class="o">-&gt;</span><span class="n">setStringList</span><span class="p">(</span><span class="n">cities</span><span class="p">);</span>
</pre></div>
</div>
<p>Another popular way to store or retrieve data is SQL. Qt comes with SQLLite embedded and has also support for other data base engines (e.g. MySQL, PostgresSQL, ...). First you need to create your database using a schema, like this:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">city</span> <span class="p">(</span><span class="n">name</span> <span class="nb">TEXT</span><span class="p">,</span> <span class="n">country</span> <span class="nb">TEXT</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">city</span> <span class="n">value</span> <span class="p">(</span><span class="ss">&quot;Munich&quot;</span><span class="p">,</span> <span class="ss">&quot;Germany&quot;</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">city</span> <span class="n">value</span> <span class="p">(</span><span class="ss">&quot;Paris&quot;</span><span class="p">,</span> <span class="ss">&quot;France&quot;</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">city</span> <span class="n">value</span> <span class="p">(</span><span class="ss">&quot;London&quot;</span><span class="p">,</span> <span class="ss">&quot;United Kingdom&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>To use sql we need to add the sql module to our .pro file</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">QT</span> <span class="o">+=</span> <span class="n">sql</span>
</pre></div>
</div>
<p>And then we can open our database using c++. First we need to retrieve a new data base object for the specified database engine. With this database object we open the database. For SQLLite  it&#8217;s enough to specify the path to the database file. Qt provides some high-level database model, one of them is the table model, which uses a table identifier and an option where clause to select the data. The resulting model can be attached to a list view as the other model before.</p>
<div class="highlight-cpp"><div class="highlight"><pre>QSqlDatabase db = QSqlDatabase::addDatabase(&quot;QSQLITE&quot;);
db.setDatabaseName(&#39;cities.db&#39;);
if(!db.open()) {
    qFatal(&quot;unable to open database&quot;);
}

m_model = QSqlTableModel(this);
m_model-&gt;setTable(&quot;city&quot;);
m_model-&gt;setHeaderData(0, Qt::Horizontal, &quot;City&quot;);
m_model-&gt;setHeaderData(1, Qt::Horizontal, &quot;Country&quot;);

view-&gt;setModel(m_model);
m_model-&gt;select();
</pre></div>
</div>
<p>For higher level of model operations Qt provides a sort file proxy model, which allows you in the basic form to sort and filter another model.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">QSortFilterProxyModel</span><span class="o">*</span> <span class="n">proxy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QSortFilterProxyModel</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="n">proxy</span><span class="o">-&gt;</span><span class="n">setSourceModel</span><span class="p">(</span><span class="n">m_model</span><span class="p">);</span>
<span class="n">view</span><span class="o">-&gt;</span><span class="n">setModel</span><span class="p">(</span><span class="n">proxy</span><span class="p">);</span>
<span class="n">view</span><span class="o">-&gt;</span><span class="n">setSortingEnabled</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
</pre></div>
</div>
<p>Filtering is done based on the column to be filters and a string as filter argument.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">proxy</span><span class="o">-&gt;</span><span class="n">setFilterKeyColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">proxy</span><span class="o">-&gt;</span><span class="n">setFilterCaseSensitive</span><span class="p">(</span><span class="n">Qt</span><span class="o">::</span><span class="n">CaseInsensitive</span><span class="p">);</span>
<span class="n">proxy</span><span class="o">-&gt;</span><span class="n">setFilterFixedString</span><span class="p">(</span><span class="n">QString</span><span class="p">)</span>
</pre></div>
</div>
<p>The filter proxy model is much more powerful than demonstrated here. For now it is enough to remember its exists.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This was an overview of the different kind of classical application you could develop with Qt5. The desktop is moving and soon the mobile devices will be our desktop of tomorrow. Mobile devices have a different user interface design. They are much more simplistic then desktop applications. They do one thing and this simple and focused. Animations is an important part. A user interface needs to feel alive and fluent. The traditional Qt technologies are not well suited for this market.</p>
<p class="last">Coming next: Qt Quick for the rescue.</p>
</div>
</div>
<div class="section" id="qt-quick-application">
<h3>2.3.4. Qt Quick Application<a class="headerlink" href="#qt-quick-application" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch02%2Findex.html%23qt-quick-application&labels=ch02">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch02&page=1&state=open">View</a></div><p>There is an inherent conflict in modern software development. The user interface is moving much faster then our back-end services. In a traditional technology you develop the so called front-end with the same pace as the back-end. Which results into conflicts when customers want to change the user interface during a project, or develop the idea of an user interface during the project. Agile projects, require agile methods.</p>
<p>Qt Quick provides a declarative environment where your user interface (the front-end) is declared like HTML and your back-end is in native c++ code. This allows you to get both from both worlds.</p>
<p>This is a simple Qt Quick UI below</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>

<span class="nx">Rectangle</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">240</span><span class="p">;</span> <span class="k">height:</span> <span class="mi">1230</span>
    <span class="nx">Rectangle</span> <span class="p">{</span>
        <span class="k">width:</span> <span class="mi">40</span><span class="p">;</span> <span class="k">height:</span> <span class="mi">40</span>
        <span class="k">anchors.centerIn:</span> <span class="nx">parent</span>
        <span class="k">color:</span> <span class="s1">&#39;#FFBB33&#39;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The declaration language is called QML and it needs to runtime to run it. Qt provides a standard runtime called <code class="docutils literal"><span class="pre">qmlscene</span></code> but it&#8217;s also not so difficult to write a custom runtime. For this we need a quick view and set the main QML document as source. The only thing left is to show the user interface.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">QQuickView</span><span class="o">*</span> <span class="n">view</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QQuickView</span><span class="p">();</span>
<span class="n">QUrl</span> <span class="n">source</span> <span class="o">=</span> <span class="n">Qurl</span><span class="o">::</span><span class="n">fromLocalUrl</span><span class="p">(</span><span class="s">&quot;main.qml&quot;</span><span class="p">);</span>
<span class="n">view</span><span class="o">-&gt;</span><span class="n">setSource</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
<span class="n">view</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
<p>Coming back to our earlier examples. In one example we used a c++ city model. It would be great if we could use this model inside our declarative QML code.</p>
<p>To enable this we first code our front-end to see how we want to use a possible city model. In this case the front-end expects a object named <code class="docutils literal"><span class="pre">cityModel</span></code> which we can use inside a list view.</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>

<span class="nx">Rectangle</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">240</span><span class="p">;</span> <span class="k">height:</span> <span class="mi">120</span>
    <span class="nx">ListView</span> <span class="p">{</span>
        <span class="k">width:</span> <span class="mi">180</span><span class="p">;</span> <span class="k">height:</span> <span class="mi">120</span>
        <span class="k">anchors.centerIn:</span> <span class="nx">parent</span>
        <span class="k">model:</span> <span class="nx">cityModel</span>
        <span class="k">delegate:</span> <span class="nx">Text</span> <span class="p">{</span> <span class="k">text:</span> <span class="nx">model</span><span class="p">.</span><span class="nx">city</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To enable the <code class="docutils literal"><span class="pre">cityModel</span></code> we can mostly re-use our previous model and add a context property to our root context (the root context is other root-element in the main document)</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">m_model</span> <span class="o">=</span> <span class="n">QSqlTableModel</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">...</span> <span class="c1">// some magic code</span>
<span class="n">QHash</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">QByteArray</span><span class="o">&gt;</span> <span class="n">roles</span><span class="p">;</span>
<span class="n">roles</span><span class="p">[</span><span class="n">Qt</span><span class="o">::</span><span class="n">UserRole</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;city&quot;</span><span class="p">;</span>
<span class="n">roles</span><span class="p">[</span><span class="n">Qt</span><span class="o">::</span><span class="n">UserRole</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;country&quot;</span><span class="p">;</span>
<span class="n">m_model</span><span class="o">-&gt;</span><span class="n">setRoleNames</span><span class="p">(</span><span class="n">roles</span><span class="p">);</span>
<span class="n">view</span><span class="o">-&gt;</span><span class="n">rootContext</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">setContextProperty</span><span class="p">(</span><span class="s">&quot;cityModel&quot;</span><span class="p">,</span> <span class="n">m_model</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is not completely correct, as the SQL table model contains the data in columns and a QML model expects the data as roles. So there needs to be a mapping between columns and roles. Please see <a class="reference external" href="http://qt-project.org/wiki/QML_and_QSqlTableModel">QML and QSqlTableModel</a> wiki page.</p>
</div>
</div>
</div>
<div class="section" id="summary">
<h2>2.4. Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch02%2Findex.html%23summary&labels=ch02">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch02&page=1&state=open">View</a></div><p>We have seen how to install the Qt SDK and how to create our first application. Then we walked you through the different application types to give you an overview of Qt, showing off some features Qt offers for application development. I hope you got a good impression that Qt is a very rich user interface toolkit and offers everything an application developer can hope for and more. Still, Qt does not lock you into specific libraries, as you always can use other libraries or extend Qt yourself. It is also rich when it comes to supporting different application models: console, classical desktop user interface and touch user interface.</p>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2012-2014 Jürgen Bocklage-Ryannel and Johan Thelin. This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.<br/>
      Last updated on May 11, 2015.<br/>
    </p>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46104829-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>