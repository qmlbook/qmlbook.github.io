<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6. Model-View-Delegate &mdash; Qt5 Cadaques Book v2015-03</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.2.0/sandstone/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2015-03',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Qt5 Cadaques Book v2015-03" href="../../index.html" />
    <link rel="next" title="7. Canvas Element" href="../ch07/index.html" />
    <link rel="prev" title="5. Fluid Elements" href="../ch05/index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          QmlBook</a>
        <span class="navbar-text navbar-version pull-left"><b>2015-03</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Chapters <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ch01/index.html">1. Meet Qt 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch02/index.html">2. Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch03/index.html">3. Qt Creator IDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch04/index.html">4. Quick Starter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch05/index.html">5. Fluid Elements</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">6. Model-View-Delegate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch07/index.html">7. Canvas Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch08/index.html">8. Particle Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch09/index.html">9. Shader Effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch10/index.html">10. Multimedia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch11/index.html">11. Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch12/index.html">12. Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch13/index.html">13. Dynamic QML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch14/index.html">14. JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch15/index.html">15. Qt and C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ch16/index.html">16. Extending QML with C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../assets/index.html">17. Assets</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">6. Model-View-Delegate</a><ul>
<li><a class="reference internal" href="#concept">6.1. Concept</a></li>
<li><a class="reference internal" href="#basic-models">6.2. Basic Models</a></li>
<li><a class="reference internal" href="#dynamic-views">6.3. Dynamic Views</a><ul>
<li><a class="reference internal" href="#orientation">6.3.1. Orientation</a></li>
<li><a class="reference internal" href="#keyboard-navigation-and-highlighting">6.3.2. Keyboard Navigation and Highlighting</a></li>
<li><a class="reference internal" href="#header-and-footer">6.3.3. Header and Footer</a></li>
<li><a class="reference internal" href="#the-gridview">6.3.4. The GridView</a></li>
</ul>
</li>
<li><a class="reference internal" href="#delegate">6.4. Delegate</a><ul>
<li><a class="reference internal" href="#animating-added-and-removed-items">6.4.1. Animating Added and Removed Items</a></li>
<li><a class="reference internal" href="#shape-shifting-delegates">6.4.2. Shape-Shifting Delegates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-techniques">6.5. Advanced Techniques</a><ul>
<li><a class="reference internal" href="#the-pathview">6.5.1. The PathView</a></li>
<li><a class="reference internal" href="#a-model-from-xml">6.5.2. A Model from XML</a></li>
<li><a class="reference internal" href="#lists-with-sections">6.5.3. Lists with Sections</a></li>
<li><a class="reference internal" href="#tuning-performance">6.5.4. Tuning Performance</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary">6.6. Summary</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../ch05/index.html" title="Previous Chapter: 5. Fluid Elements"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 5. Fluid Element...</span>
    </a>
  </li>
  <li>
    <a href="../ch07/index.html" title="Next Chapter: 7. Canvas Element"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">7. Canvas Elemen... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">6. Model-View-Delegate</a><ul>
<li><a class="reference internal" href="#concept">6.1. Concept</a></li>
<li><a class="reference internal" href="#basic-models">6.2. Basic Models</a></li>
<li><a class="reference internal" href="#dynamic-views">6.3. Dynamic Views</a><ul>
<li><a class="reference internal" href="#orientation">6.3.1. Orientation</a></li>
<li><a class="reference internal" href="#keyboard-navigation-and-highlighting">6.3.2. Keyboard Navigation and Highlighting</a></li>
<li><a class="reference internal" href="#header-and-footer">6.3.3. Header and Footer</a></li>
<li><a class="reference internal" href="#the-gridview">6.3.4. The GridView</a></li>
</ul>
</li>
<li><a class="reference internal" href="#delegate">6.4. Delegate</a><ul>
<li><a class="reference internal" href="#animating-added-and-removed-items">6.4.1. Animating Added and Removed Items</a></li>
<li><a class="reference internal" href="#shape-shifting-delegates">6.4.2. Shape-Shifting Delegates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-techniques">6.5. Advanced Techniques</a><ul>
<li><a class="reference internal" href="#the-pathview">6.5.1. The PathView</a></li>
<li><a class="reference internal" href="#a-model-from-xml">6.5.2. A Model from XML</a></li>
<li><a class="reference internal" href="#lists-with-sections">6.5.3. Lists with Sections</a></li>
<li><a class="reference internal" href="#tuning-performance">6.5.4. Tuning Performance</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary">6.6. Summary</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9">
      
  <div class="section" id="model-view-delegate">
<h1>6. Model-View-Delegate<a class="headerlink" href="#model-view-delegate" title="Permalink to this headline">¶</a></h1>
<p><em>Section author: <a class="reference external" href="https://bitbucket.org/e8johan">e8johan</a></em></p>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23model-view-delegate&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Last Build: March 15, 2015 at 10:13 CET</p>
<p class="last">The source code for this chapter can be found in the <a class="reference external" href="../assets">assets folder</a>.</p>
</div>
<p>In QtQuick, data is separated from the presentation through a model-view separation. For each view, the visualization of each data element is separated into a delegate. QtQuick comes with a set of predefined models and views. To utilize the system, one must understand these classes and know how to create appropriate delegates to get the right look and feel.</p>
<div class="section" id="concept">
<h2>6.1. Concept<a class="headerlink" href="#concept" title="Permalink to this headline">¶</a></h2>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23concept&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>One of the most important aspects when developing user interfaces, is to keep the representation of the data separate from the visualization. For instance, a phonebook could be arranged as a vertical list of text entries or a grid of pictures of the contacts. In both cases, the data is identical: the phonebook, but the visualization differs. This division is commonly referred to as the model-view pattern. In this pattern the data is referred to as the model, while the visualization is handled by the view.</p>
<p>In QML, the model and view are joined by the delegate. The responsibility are divided as follows. The model provides the data. For each data item, there might be multiple values. In the example above, each phonebook entry has a name, a picture and a number. The data is arranged in a view, in which each item is visualized using a delegate. The task of the view is to arrange the delegates, while each delegate shows the values of each model item to the user.</p>
<p class="graphviz">
<img src="../../_images/graphviz-00dabdd0a911009b7da04ffd00f7c1537eab1281.png" alt="digraph model_view_delegate_roles {
View -&gt; Model [label=&quot;Visualizes Model&quot;]
Delegate -&gt; Model [label=&quot;Visualizes Model Rows&quot;]
View -&gt; Delegate [label=&quot;Creates and Places&quot;]
}" />
</p>
</div>
<div class="section" id="basic-models">
<h2>6.2. Basic Models<a class="headerlink" href="#basic-models" title="Permalink to this headline">¶</a></h2>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23basic-models&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>The most basic way to separate the data from the presentation is to use the <tt class="docutils literal"><span class="pre">Repeater</span></tt> element. It is used to instantiate an array of items, and is easy to combine with a positioner to populate a part of the user interface. A repeater uses a model, which can be anything from the number of items to instantiate, to a fully blown model gathering data from the Internet.</p>
<p>In its simplest form, the repeater can be used to instantiate a specified number of items. Each item will have access to an attached property, the variable <tt class="docutils literal"><span class="pre">index</span></tt>, that can be used to tell the items apart. In the example below, a repeater is used to create 10 instances of an item. The number of items are controlled using the <tt class="docutils literal"><span class="pre">model</span></tt> property. For each item, the <tt class="docutils literal"><span class="pre">Rectangle</span></tt> containing a <tt class="docutils literal"><span class="pre">Text</span></tt> element found inside the <tt class="docutils literal"><span class="pre">Repeater</span></tt> item, is instantiated. As you can tell, the <tt class="docutils literal"><span class="pre">text</span></tt> property is set to the <tt class="docutils literal"><span class="pre">index</span></tt> value, thus the items are numbered from zero to nine.</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>
<span class="kr">import</span> <span class="s2">&quot;../common&quot;</span>

<span class="nx">Column</span> <span class="p">{</span>
    <span class="k">spacing:</span> <span class="mi">2</span>

    <span class="nx">Repeater</span> <span class="p">{</span>
        <span class="k">model:</span> <span class="mi">10</span>
        <span class="nx">BlueBox</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="mi">120</span>
            <span class="k">height:</span> <span class="mi">32</span>
            <span class="k">text:</span> <span class="nx">index</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<img alt="../../_images/repeater-number.png" id="ex01" src="../../_images/repeater-number.png" />
<p>As nice as lists of numbered items are, it is sometimes interesting to display a more complex data set. By replacing the integer <tt class="docutils literal"><span class="pre">model</span></tt> value with a JavaScript array, we can achieve that. The contents of the array can be of any type, be it strings, integers or objects. In the example below, a list of strings is used. We can still access and use the <tt class="docutils literal"><span class="pre">index</span></tt> variable, but we also have access to <tt class="docutils literal"><span class="pre">modelData</span></tt> containing the data for each element in the array.</p>
<div class="highlight-qml" id="ex02"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>
<span class="kr">import</span> <span class="s2">&quot;../common&quot;</span>

<span class="nx">Column</span> <span class="p">{</span>
    <span class="k">spacing:</span> <span class="mi">2</span>

    <span class="nx">Repeater</span> <span class="p">{</span>
        <span class="k">model:</span> <span class="p">[</span><span class="s2">&quot;Enterprise&quot;</span><span class="p">,</span> <span class="s2">&quot;Colombia&quot;</span><span class="p">,</span> <span class="s2">&quot;Challenger&quot;</span><span class="p">,</span> <span class="s2">&quot;Discovery&quot;</span><span class="p">,</span> <span class="s2">&quot;Endeavour&quot;</span><span class="p">,</span> <span class="s2">&quot;Atlantis&quot;</span><span class="p">]</span>

        <span class="nx">BlueBox</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="mi">100</span>
            <span class="k">height:</span> <span class="mi">32</span>
            <span class="k">radius:</span> <span class="mi">3</span>

            <span class="k">text:</span> <span class="nx">modelData</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="nx">index</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<img alt="../../_images/repeater-array.png" src="../../_images/repeater-array.png" />
<p>Being able to expose the data of an array, you soon find yourself in a position where you need multiple pieces of data per item in the array. This is where models enter the picture. One of the most trivial models, and one of the most commonly used, is the <tt class="docutils literal"><span class="pre">ListModel</span></tt>. A list model is simply a collection of <tt class="docutils literal"><span class="pre">ListElement</span></tt> items. Inside each list element, a number of properties can be bound to values. For instance, in the example below, a name and an image URL is provided for each element.</p>
<p>The properties bound inside each element are attached to each instantiated item by the repeater. This means that the variables <tt class="docutils literal"><span class="pre">name</span></tt> and <tt class="docutils literal"><span class="pre">surfaceColor</span></tt> are available from within the scope of each <tt class="docutils literal"><span class="pre">Rectangle</span></tt> and <tt class="docutils literal"><span class="pre">Text</span></tt> item created by the repeater. This not only makes it easy to access the data, it also makes it easy to read the source code. The <tt class="docutils literal"><span class="pre">surfaceColor</span></tt> is the color of the circle to the left of the name, not something obscure as data from column <tt class="docutils literal"><span class="pre">i</span></tt> of row <tt class="docutils literal"><span class="pre">j</span></tt>.</p>
<div class="highlight-qml" id="ex03"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>
<span class="kr">import</span> <span class="s2">&quot;../common&quot;</span>

<span class="nx">Column</span> <span class="p">{</span>
    <span class="k">spacing:</span> <span class="mi">2</span>

    <span class="nx">Repeater</span> <span class="p">{</span>
        <span class="k">model:</span> <span class="nx">ListModel</span> <span class="p">{</span>
            <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Mercury&quot;</span><span class="p">;</span> <span class="k">surfaceColor:</span> <span class="s2">&quot;gray&quot;</span> <span class="p">}</span>
            <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Venus&quot;</span><span class="p">;</span> <span class="k">surfaceColor:</span> <span class="s2">&quot;yellow&quot;</span> <span class="p">}</span>
            <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Earth&quot;</span><span class="p">;</span> <span class="k">surfaceColor:</span> <span class="s2">&quot;blue&quot;</span> <span class="p">}</span>
            <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Mars&quot;</span><span class="p">;</span> <span class="k">surfaceColor:</span> <span class="s2">&quot;orange&quot;</span> <span class="p">}</span>
            <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Jupiter&quot;</span><span class="p">;</span> <span class="k">surfaceColor:</span> <span class="s2">&quot;orange&quot;</span> <span class="p">}</span>
            <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Saturn&quot;</span><span class="p">;</span> <span class="k">surfaceColor:</span> <span class="s2">&quot;yellow&quot;</span> <span class="p">}</span>
            <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Uranus&quot;</span><span class="p">;</span> <span class="k">surfaceColor:</span> <span class="s2">&quot;lightBlue&quot;</span> <span class="p">}</span>
            <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Neptune&quot;</span><span class="p">;</span> <span class="k">surfaceColor:</span> <span class="s2">&quot;lightBlue&quot;</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">BlueBox</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="mi">120</span>
            <span class="k">height:</span> <span class="mi">32</span>

            <span class="k">radius:</span> <span class="mi">3</span>
            <span class="k">text:</span> <span class="nx">name</span>

            <span class="nx">Box</span> <span class="p">{</span>
                <span class="k">anchors.left:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">left</span>
                <span class="k">anchors.verticalCenter:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">verticalCenter</span>
                <span class="k">anchors.leftMargin:</span> <span class="mi">4</span>

                <span class="k">width:</span> <span class="mi">16</span>
                <span class="k">height:</span> <span class="mi">16</span>

                <span class="k">radius:</span> <span class="mi">8</span>

                <span class="k">color:</span> <span class="nx">surfaceColor</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<img alt="../../_images/repeater-model.png" src="../../_images/repeater-model.png" />
<p>The contents of the repeater that is being instantiated for each item is actually what is bound to the default property, <tt class="docutils literal"><span class="pre">delegate</span></tt>. This means that the code of example <a class="reference internal" href="#ex01"><em>Example 01</em></a> is synonymous to the code shown below. Notice that the only difference is that the <tt class="docutils literal"><span class="pre">delegate</span></tt> property name is spelled out explicitly in the latter.</p>
<div class="highlight-qml" id="ex04"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>
<span class="kr">import</span> <span class="s2">&quot;../common&quot;</span>

<span class="nx">Column</span> <span class="p">{</span>
    <span class="k">spacing:</span> <span class="mi">2</span>

    <span class="nx">Repeater</span> <span class="p">{</span>
        <span class="k">model:</span> <span class="mi">10</span>

        <span class="k">delegate:</span> <span class="nx">BlueBox</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="mi">100</span>
            <span class="k">height:</span> <span class="mi">32</span>
            <span class="k">text:</span> <span class="nx">index</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="dynamic-views">
<h2>6.3. Dynamic Views<a class="headerlink" href="#dynamic-views" title="Permalink to this headline">¶</a></h2>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23dynamic-views&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>Repeaters work well for limited and static sets of data, but in the real world, models are commonly more complex &#8211; and larger. Here, a smarter solution is needed. For this, QtQuick provides the <tt class="docutils literal"><span class="pre">ListView</span></tt> and <tt class="docutils literal"><span class="pre">GridView</span></tt> elements. These are both based on a <tt class="docutils literal"><span class="pre">Flickable</span></tt> area, so the user can move around in a larger data set. At the same time, they limit the number of concurrently instantiated delegates. For a large model, that means fewer elements in the scene at once.</p>
<img alt="../../_images/listview-basic.png" src="../../_images/listview-basic.png" />
<img alt="../../_images/gridview-basic.png" src="../../_images/gridview-basic.png" />
<p>The two elements are similar in their usage. Thus, we will begin with the <tt class="docutils literal"><span class="pre">ListView</span></tt> and then describe the <tt class="docutils literal"><span class="pre">GridView</span></tt> with the former as the starting point of the comparison.</p>
<p>The <tt class="docutils literal"><span class="pre">ListView</span></tt> is similar to the <tt class="docutils literal"><span class="pre">Repeater</span></tt> element. It uses a <tt class="docutils literal"><span class="pre">model</span></tt>, instantiates a <tt class="docutils literal"><span class="pre">delegate</span></tt> and between the delegates, there can be <tt class="docutils literal"><span class="pre">spacing</span></tt>. The listing below shows how a simple setup can look.</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>
<span class="kr">import</span> <span class="s2">&quot;../common&quot;</span>

<span class="nx">Background</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">80</span>
    <span class="k">height:</span> <span class="mi">300</span>

    <span class="nx">ListView</span> <span class="p">{</span>
        <span class="k">anchors.fill:</span> <span class="nx">parent</span>
        <span class="k">anchors.margins:</span> <span class="mi">20</span>

        <span class="k">clip:</span> <span class="kc">true</span>

        <span class="k">model:</span> <span class="mi">100</span>

        <span class="k">delegate:</span> <span class="nx">numberDelegate</span>
        <span class="k">spacing:</span> <span class="mi">5</span>
    <span class="p">}</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: numberDelegate</span>

        <span class="nx">GreenBox</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="mi">40</span>
            <span class="k">height:</span> <span class="mi">40</span>
            <span class="k">text:</span> <span class="nx">index</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<img alt="../../_images/listview-basic.png" src="../../_images/listview-basic.png" />
<p>If the model contains more data than can fit onto the screen, the <tt class="docutils literal"><span class="pre">ListView</span></tt> only shows part of the list. However, as a consequence of the default behavior of QtQuick, the list view does not limit the screen area within which the delegates are shown. This means that delegates may be visible outside the list view, and that the dynamic creation and destruction of delegates outside the list view is visible to the user. To prevent this, clipping must be activated on the <tt class="docutils literal"><span class="pre">ListView</span></tt> element by setting the <tt class="docutils literal"><span class="pre">clip</span></tt> property to <tt class="docutils literal"><span class="pre">true</span></tt>. The illustration below shows the result of this, compared to when the <tt class="docutils literal"><span class="pre">clip</span></tt> property is left as <tt class="docutils literal"><span class="pre">false</span></tt>.</p>
<img alt="../../_images/listview-clip.png" src="../../_images/listview-clip.png" />
<p>To the user, the <tt class="docutils literal"><span class="pre">ListView</span></tt> is a scrollable area. It supports kinetic scrolling, which means that it can be flicked to quickly move through the contents. By default, it also can be stretched beyond the end of contents, and then bounces back, to signal to the user that the end has been reached.</p>
<p>The behavior at the end of the view is controlled using the <tt class="docutils literal"><span class="pre">boundsBehavior</span></tt> property. This is an enumerated value and can be configured from the default behavior, <tt class="docutils literal"><span class="pre">Flickable.DragAndOvershootBounds</span></tt>, where the view can be both dragged and flicked outside its boundaries, to <tt class="docutils literal"><span class="pre">Flickable.StopAtBounds</span></tt>, where the view never will move outside its boundaries. The middle ground, <tt class="docutils literal"><span class="pre">Flickable.DragOverBounds</span></tt> lets the user drag the view outside its boundaries, but flicks will stop at the boundary.</p>
<p>It is possible to limit the positions where a view is allowed to stop. This is controlled using the <tt class="docutils literal"><span class="pre">snapMode</span></tt> property. The default behavior, <tt class="docutils literal"><span class="pre">ListView.NoSnap</span></tt>, lets the view stop at any position. By setting the <tt class="docutils literal"><span class="pre">snapMode</span></tt> property to <tt class="docutils literal"><span class="pre">ListView.SnapToItem</span></tt>, the view will always align the top of an item with its top. Finally, the <tt class="docutils literal"><span class="pre">ListView.SnapOneItem</span></tt>, the view will stop no more than one item from the first visible item when the mouse button or touch was released. The last mode is very handy when flipping through pages.</p>
<div class="section" id="orientation">
<h3>6.3.1. Orientation<a class="headerlink" href="#orientation" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23orientation&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>The list view provides a vertically scrolling list by default, but horizontal scrolling can be just as useful. The direction of the list view is controlled through the <tt class="docutils literal"><span class="pre">orientation</span></tt> property. It can be set to either the default value, <tt class="docutils literal"><span class="pre">ListView.Vertical</span></tt>, or to <tt class="docutils literal"><span class="pre">ListView.Horizontal</span></tt>. A horizontal list view is shown below.</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>
<span class="kr">import</span> <span class="s2">&quot;../common&quot;</span>

<span class="nx">Background</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">480</span>
    <span class="k">height:</span> <span class="mi">80</span>

    <span class="nx">ListView</span> <span class="p">{</span>
        <span class="k">anchors.fill:</span> <span class="nx">parent</span>
        <span class="k">anchors.margins:</span> <span class="mi">20</span>
        <span class="k">spacing:</span> <span class="mi">4</span>
        <span class="k">clip:</span> <span class="kc">true</span>
        <span class="k">model:</span> <span class="mi">100</span>
        <span class="k">orientation:</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">Horizontal</span>
        <span class="k">delegate:</span> <span class="nx">numberDelegate</span>
    <span class="p">}</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: numberDelegate</span>

        <span class="nx">GreenBox</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="mi">40</span>
            <span class="k">height:</span> <span class="mi">40</span>
            <span class="k">text:</span> <span class="nx">index</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<img alt="../../_images/listview-horizontal.png" src="../../_images/listview-horizontal.png" />
<p>As you can tell, the direction of the horizontal flows from the left to the right by default. This can be controlled through the <tt class="docutils literal"><span class="pre">layoutDirection</span></tt> property, which can be set to either <tt class="docutils literal"><span class="pre">Qt.LeftToRight</span></tt> or <tt class="docutils literal"><span class="pre">Qt.RightToLeft</span></tt>, depending on the flow direction.</p>
</div>
<div class="section" id="keyboard-navigation-and-highlighting">
<h3>6.3.2. Keyboard Navigation and Highlighting<a class="headerlink" href="#keyboard-navigation-and-highlighting" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23keyboard-navigation-and-highlighting&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>When using a <tt class="docutils literal"><span class="pre">ListView</span></tt> in a touch based setting, the view itself is enough. In a scenario with a keyboard, or even just arrow keys to select an item, a mechanism to indicate the current item is needed. In QML, this is called highlighting.</p>
<p>Views support a highlight delegate which is shown in the view together with the delegates. It can be considered an additional delegate, only that it is only instantiated once, and is moved into the same position as the current item.</p>
<p>In the example below this is demonstrated. There are two properties involved for this to work. First, the <tt class="docutils literal"><span class="pre">focus</span></tt> property is set to true. This gives the <tt class="docutils literal"><span class="pre">ListView</span></tt> the keyboard focus. Second, the <tt class="docutils literal"><span class="pre">highlight</span></tt> property is set to point out the highlighting delegate to use. The highlight delegate is given the <tt class="docutils literal"><span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">y</span></tt> and <tt class="docutils literal"><span class="pre">height</span></tt> of the current item. If the <tt class="docutils literal"><span class="pre">width</span></tt> is not specified, the width of the current item is also used.</p>
<p>In the example, the <tt class="docutils literal"><span class="pre">ListView.view.width</span></tt> attached property is used for width. The attached properties available to delegates are discussed further in the delegate section of this chapter, but it is good to know that the same properties are available to highlight delegates as well.</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>
<span class="kr">import</span> <span class="s2">&quot;../common&quot;</span>

<span class="nx">Background</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">240</span>
    <span class="k">height:</span> <span class="mi">300</span>

    <span class="nx">ListView</span> <span class="p">{</span>
        <span class="kd">id: view</span>
        <span class="k">anchors.fill:</span> <span class="nx">parent</span>
        <span class="k">anchors.margins:</span> <span class="mi">20</span>

        <span class="k">clip:</span> <span class="kc">true</span>

        <span class="k">model:</span> <span class="mi">100</span>

        <span class="k">delegate:</span> <span class="nx">numberDelegate</span>
        <span class="k">spacing:</span> <span class="mi">5</span>

        <span class="k">highlight:</span> <span class="nx">highlightComponent</span>
        <span class="k">focus:</span> <span class="kc">true</span>
    <span class="p">}</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: highlightComponent</span>

        <span class="nx">GreenBox</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">width</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: numberDelegate</span>

        <span class="nx">Item</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">width</span>
            <span class="k">height:</span> <span class="mi">40</span>

            <span class="nx">Text</span> <span class="p">{</span>
                <span class="k">anchors.centerIn:</span> <span class="nx">parent</span>

                <span class="k">font.pixelSize:</span> <span class="mi">10</span>

                <span class="k">text:</span> <span class="nx">index</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// M1&gt;&gt;</span>
</pre></div>
</div>
<img alt="../../_images/listview-highlight.png" src="../../_images/listview-highlight.png" />
<p>When using a highlight in conjunction with a <tt class="docutils literal"><span class="pre">ListView</span></tt>, a number of properties can be used to control its behavior. The <tt class="docutils literal"><span class="pre">highlightRangeMode</span></tt> controls how the highlight is affected by what is shown in the view. The default setting, <tt class="docutils literal"><span class="pre">ListView.NoHighlightRange</span></tt> means that the highlight and the visible range of items in the view not are related at all.</p>
<p>The value <tt class="docutils literal"><span class="pre">ListView.StrictlyEnforceRange</span></tt> ensures that the highlight always is visible. If an action attempts to move the highlight outside the visible part of the view, the current item will change accordingly, so that the highlight remains visible.</p>
<p>The middle ground is the <tt class="docutils literal"><span class="pre">ListView.ApplyRange</span></tt> value. It attempts to keep the highlight visible, but does not alter the current item to enforce this. Instead, the highlight is allowed to move out of view if necessary.</p>
<p>In the default configuration, the view is responsible for moving the highlight into position. The speed of the movement and resizing can be controlled, either as a speed or as a duration. The properties involved are <tt class="docutils literal"><span class="pre">highlightMoveSpeed</span></tt>, <tt class="docutils literal"><span class="pre">highlightMoveDuration</span></tt>, <tt class="docutils literal"><span class="pre">highlightResizeSpeed</span></tt> and <tt class="docutils literal"><span class="pre">highlightResizeDuration</span></tt>. By default, the speed is set to 400 pixels per second, and the duration is set to -1, indicating that the speed and distance control the duration. If both a speed and a duration is set, the one that results in the quickest animation is chosen.</p>
<p>To control the movement of the highlight more in detail, the <tt class="docutils literal"><span class="pre">highlightFollowCurrentItem</span></tt> property can be set to <tt class="docutils literal"><span class="pre">false</span></tt>. This means that the view is no longer responsible for the movement of the highlight delegate. Instead, the movement can be controlled through a <tt class="docutils literal"><span class="pre">Behavior</span></tt> or an animation.</p>
<p>In the example below, the <tt class="docutils literal"><span class="pre">y</span></tt> property of the highlight delegate is bound to the <tt class="docutils literal"><span class="pre">ListView.view.currentItem.y</span></tt> attached property. This ensures that the highlight follows the current item. However, as we do not let the view move the highlight, we can control how the element is moved. This is done through the <tt class="docutils literal"><span class="pre">Behavior</span> <span class="pre">on</span> <span class="pre">y</span></tt>. In the example below, the movement is divided into three steps: fading out, moving, before fading in. Notice how <tt class="docutils literal"><span class="pre">SequentialAnimation</span></tt> and <tt class="docutils literal"><span class="pre">PropertyAnimation</span></tt> elements can be used in combination with the <tt class="docutils literal"><span class="pre">NumberAnimation</span></tt> to create a more complex movement.</p>
<div class="highlight-qml"><div class="highlight"><pre>    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: highlightComponent</span>

        <span class="nx">Item</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">width</span>
            <span class="k">height:</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">currentItem</span><span class="p">.</span><span class="nx">height</span>

            <span class="k">y:</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">currentItem</span><span class="p">.</span><span class="nx">y</span>

            <span class="nx">Behavior</span> <span class="nx">on</span> <span class="nx">y</span> <span class="p">{</span>
                <span class="nx">SequentialAnimation</span> <span class="p">{</span>
                    <span class="nx">PropertyAnimation</span> <span class="p">{</span> <span class="k">target:</span> <span class="nx">highlightRectangle</span><span class="p">;</span> <span class="k">property:</span> <span class="s2">&quot;opacity&quot;</span><span class="p">;</span> <span class="k">to:</span> <span class="mi">0</span><span class="p">;</span> <span class="k">duration:</span> <span class="mi">200</span> <span class="p">}</span>
                    <span class="nx">NumberAnimation</span> <span class="p">{</span> <span class="k">duration:</span> <span class="mi">1</span> <span class="p">}</span>
                    <span class="nx">PropertyAnimation</span> <span class="p">{</span> <span class="k">target:</span> <span class="nx">highlightRectangle</span><span class="p">;</span> <span class="k">property:</span> <span class="s2">&quot;opacity&quot;</span><span class="p">;</span> <span class="k">to:</span> <span class="mi">1</span><span class="p">;</span> <span class="k">duration:</span> <span class="mi">200</span> <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="nx">GreenBox</span> <span class="p">{</span>
                <span class="kd">id: highlightRectangle</span>
                <span class="k">anchors.fill:</span> <span class="nx">parent</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="header-and-footer">
<h3>6.3.3. Header and Footer<a class="headerlink" href="#header-and-footer" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23header-and-footer&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>At the end of the <tt class="docutils literal"><span class="pre">ListView</span></tt> contents, a <tt class="docutils literal"><span class="pre">header</span></tt> and a <tt class="docutils literal"><span class="pre">footer</span></tt> element can be inserted. These can be considered special delegates places at the beginning or end of the list. For a horizontal list, these will not appear at the head or foot, but rather at then beginning or end, depending on the <tt class="docutils literal"><span class="pre">layoutDirection</span></tt> used.</p>
<p>The example below illustrates how an header and footer can be used to enhance the perception of the beginning and end of a list. There are other uses for these special list elements. For instance, they can be used to keep buttons to load more contents.</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>
<span class="kr">import</span> <span class="s2">&quot;../common&quot;</span>

<span class="nx">Background</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">240</span>
    <span class="k">height:</span> <span class="mi">300</span>

    <span class="nx">ListView</span> <span class="p">{</span>
        <span class="k">anchors.fill:</span> <span class="nx">parent</span>
        <span class="k">anchors.margins:</span> <span class="mi">20</span>

        <span class="k">clip:</span> <span class="kc">true</span>

        <span class="k">model:</span> <span class="mi">4</span>

        <span class="k">delegate:</span> <span class="nx">numberDelegate</span>
        <span class="k">spacing:</span> <span class="mi">2</span>

        <span class="k">header:</span> <span class="nx">headerComponent</span>
        <span class="k">footer:</span> <span class="nx">footerComponent</span>
    <span class="p">}</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: headerComponent</span>

        <span class="nx">YellowBox</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">width</span>
            <span class="k">height:</span> <span class="mi">20</span>
            <span class="k">text:</span> <span class="s1">&#39;Header&#39;</span>

        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: footerComponent</span>

        <span class="nx">YellowBox</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">width</span>
            <span class="k">height:</span> <span class="mi">20</span>
            <span class="k">text:</span> <span class="s1">&#39;Footer&#39;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: numberDelegate</span>

        <span class="nx">GreenBox</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">width</span>
            <span class="k">height:</span> <span class="mi">40</span>
            <span class="k">text:</span> <span class="s1">&#39;Item #&#39;</span> <span class="o">+</span> <span class="nx">index</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Header and footer delegates do not respect the <tt class="docutils literal"><span class="pre">spacing</span></tt> property of a <tt class="docutils literal"><span class="pre">ListView</span></tt>, instead they are placed directly adjacent to the next item delegate in the list. This means that any spacing must be a part of the header and footer items.</p>
</div>
<img alt="../../_images/listview-header-footer.png" src="../../_images/listview-header-footer.png" />
</div>
<div class="section" id="the-gridview">
<h3>6.3.4. The GridView<a class="headerlink" href="#the-gridview" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23the-gridview&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>Using a <tt class="docutils literal"><span class="pre">GridView</span></tt> is very similar to using a <tt class="docutils literal"><span class="pre">ListView</span></tt>. The only real difference is that the grid view places the delegates in a two dimensional grid instead of in a linear list.</p>
<img alt="../../_images/gridview-basic.png" src="../../_images/gridview-basic.png" />
<p>Compared to a list view, the grid view does not rely on spacing and the size of its delegates. Instead, it uses the <tt class="docutils literal"><span class="pre">cellWidth</span></tt> and <tt class="docutils literal"><span class="pre">cellHeight</span></tt> properties to control the dimensions of the contents delegates. Each delegate item is then places in the top left corner of each such cell.</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>
<span class="kr">import</span> <span class="s2">&quot;../common&quot;</span>

<span class="nx">Background</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">220</span>
    <span class="k">height:</span> <span class="mi">300</span>

    <span class="nx">GridView</span> <span class="p">{</span>
        <span class="kd">id: view</span>
        <span class="k">anchors.fill:</span> <span class="nx">parent</span>
        <span class="k">anchors.margins:</span> <span class="mi">20</span>

        <span class="k">clip:</span> <span class="kc">true</span>

        <span class="k">model:</span> <span class="mi">100</span>

        <span class="k">cellWidth:</span> <span class="mi">45</span>
        <span class="k">cellHeight:</span> <span class="mi">45</span>

        <span class="k">delegate:</span> <span class="nx">numberDelegate</span>
    <span class="p">}</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: numberDelegate</span>

        <span class="nx">GreenBox</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="mi">40</span>
            <span class="k">height:</span> <span class="mi">40</span>
            <span class="k">text:</span> <span class="nx">index</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A <tt class="docutils literal"><span class="pre">GridView</span></tt> contains headers and footers, can use a highlight delegate and supports snap modes as well as various bounds behaviors. It can also be orientated in different directions and orientations.</p>
<p>The orientation is controlled using the <tt class="docutils literal"><span class="pre">flow</span></tt> property. It can be set to either <tt class="docutils literal"><span class="pre">GridView.LeftToRight</span></tt> or <tt class="docutils literal"><span class="pre">GridView.TopToBottom</span></tt>. The former value fills a grid from the left to the right, adding rows from the top to the bottom. The view is scrollable in the vertical direction. The latter value adds items from the top to the bottom, filling the view from left to right. The scrolling direction is horizontal in this case.</p>
<p>In addition to the <tt class="docutils literal"><span class="pre">flow</span></tt> property, the <tt class="docutils literal"><span class="pre">layoutDirection</span></tt> property can adapt the direction of the grid to left-to-right or right-to-left languages, depending on the value used.</p>
</div>
</div>
<div class="section" id="delegate">
<h2>6.4. Delegate<a class="headerlink" href="#delegate" title="Permalink to this headline">¶</a></h2>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23delegate&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>When it comes to using models and views in a custom user interface, the delegate plays a huge role in creating a look. As each item in a the model are visualized through a delegate, what is actually visible to the user are the delegates.</p>
<p>Each delegate gets access to a number of attached properties, some from the data model, others from the view. From the model, the properties convey the data for each item to the delegate. From the view, the properties convey state information related to the delegate within the view.</p>
<p>The most commonly used properties attached from the view are <tt class="docutils literal"><span class="pre">ListView.isCurrentItem</span></tt> and <tt class="docutils literal"><span class="pre">ListView.view</span></tt>. The first is a boolean indicating if the item is the current item, while the latter is a read-only reference to the actual view. Through access to the view, it is possible to create general, reusable delegates that adapt to the size and nature of the view in which they are contained. In the example below, the <tt class="docutils literal"><span class="pre">width</span></tt> of each delegate is bound to the <tt class="docutils literal"><span class="pre">width</span></tt> of the view, while the background <tt class="docutils literal"><span class="pre">color</span></tt> of each delegate depends on the attached <tt class="docutils literal"><span class="pre">ListView.isCurrentItem</span></tt> property.</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>

<span class="nx">Rectangle</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">120</span>
    <span class="k">height:</span> <span class="mi">300</span>

    <span class="k">gradient:</span> <span class="nx">Gradient</span> <span class="p">{</span>
        <span class="nx">GradientStop</span> <span class="p">{</span> <span class="k">position:</span> <span class="mf">0.0</span><span class="p">;</span> <span class="k">color:</span> <span class="s2">&quot;#f6f6f6&quot;</span> <span class="p">}</span>
        <span class="nx">GradientStop</span> <span class="p">{</span> <span class="k">position:</span> <span class="mf">1.0</span><span class="p">;</span> <span class="k">color:</span> <span class="s2">&quot;#d7d7d7&quot;</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">ListView</span> <span class="p">{</span>
        <span class="k">anchors.fill:</span> <span class="nx">parent</span>
        <span class="k">anchors.margins:</span> <span class="mi">20</span>

        <span class="k">clip:</span> <span class="kc">true</span>

        <span class="k">model:</span> <span class="mi">100</span>

        <span class="k">delegate:</span> <span class="nx">numberDelegate</span>
        <span class="k">spacing:</span> <span class="mi">5</span>

        <span class="k">focus:</span> <span class="kc">true</span>
    <span class="p">}</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: numberDelegate</span>

        <span class="nx">Rectangle</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">width</span>
            <span class="k">height:</span> <span class="mi">40</span>

            <span class="k">color:</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">isCurrentItem</span><span class="o">?</span><span class="s2">&quot;#157efb&quot;</span><span class="o">:</span><span class="s2">&quot;#53d769&quot;</span>
            <span class="k">border.color:</span> <span class="nx">Qt</span><span class="p">.</span><span class="nx">lighter</span><span class="p">(</span><span class="nx">color</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

            <span class="nx">Text</span> <span class="p">{</span>
                <span class="k">anchors.centerIn:</span> <span class="nx">parent</span>

                <span class="k">font.pixelSize:</span> <span class="mi">10</span>

                <span class="k">text:</span> <span class="nx">index</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<img alt="../../_images/delegates-basic.png" src="../../_images/delegates-basic.png" />
<p>If each item in the model is associated with an action, for instance, clicking an item acts upon it, that functionality is a part of each delegate. This divides the event management between the view, which handles the navigation between items in the view, and the delegate which handles actions on a specific item.</p>
<p>The most basic way to do this is to create a <tt class="docutils literal"><span class="pre">MouseArea</span></tt> within each delegate and act on the <tt class="docutils literal"><span class="pre">onClicked</span></tt> signal. This is demonstrated in the example in the next section of this chapter.</p>
<div class="section" id="animating-added-and-removed-items">
<h3>6.4.1. Animating Added and Removed Items<a class="headerlink" href="#animating-added-and-removed-items" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23animating-added-and-removed-items&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>In some cases, the contents shown in a view changes over time. Items are added and removed as the underlaying data model is altered. In these cases, it is often a good idea to employ visual ques to give the user a sense of direction. to help the user understand what data is added or removed.</p>
<p>Conveniently enough, QML views attaches two signals, <tt class="docutils literal"><span class="pre">onAdd</span></tt> and <tt class="docutils literal"><span class="pre">onRemove</span></tt>, to each item delegate. By connecting animations to these, it is easy to create the movement necessary to aid the user in identifying what is taking place.</p>
<p>The example below demonstrates this through the use of a dynamically populated <tt class="docutils literal"><span class="pre">ListModel</span></tt>. At the bottom of the screen, a button for adding new items is shown. When it is clicked, a new item is added to the model using the <tt class="docutils literal"><span class="pre">append</span></tt> method. This triggers the creation of a new delegate in the view, and the emission of the <tt class="docutils literal"><span class="pre">GridView.onAdd</span></tt> signal. The <tt class="docutils literal"><span class="pre">SequentialAnimation</span></tt> attached to the signal causes the item to zoom into view by animating the <tt class="docutils literal"><span class="pre">scale</span></tt> property of the delegate.</p>
<p>When a delegate in the view is clicked, the item is removed from the model through a call to the <tt class="docutils literal"><span class="pre">remove</span></tt> method. This causes the <tt class="docutils literal"><span class="pre">GridView.onRemove</span></tt> signal to be emitted, triggering another <tt class="docutils literal"><span class="pre">SequentialAnimation</span></tt>. This time, however, the destruction of the delegate must be delayed until the animation has completed. To do this, <tt class="docutils literal"><span class="pre">PropertyAction</span></tt> element are used to set the <tt class="docutils literal"><span class="pre">GridView.delayRemove</span></tt> property to <tt class="docutils literal"><span class="pre">true</span></tt> before the animation, and <tt class="docutils literal"><span class="pre">false</span></tt> after. This ensures that the animation is allowed to complete before the delegate item is removed.</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>

<span class="nx">Rectangle</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">480</span>
    <span class="k">height:</span> <span class="mi">300</span>

    <span class="k">gradient:</span> <span class="nx">Gradient</span> <span class="p">{</span>
        <span class="nx">GradientStop</span> <span class="p">{</span> <span class="k">position:</span> <span class="mf">0.0</span><span class="p">;</span> <span class="k">color:</span> <span class="s2">&quot;#dbddde&quot;</span> <span class="p">}</span>
        <span class="nx">GradientStop</span> <span class="p">{</span> <span class="k">position:</span> <span class="mf">1.0</span><span class="p">;</span> <span class="k">color:</span> <span class="s2">&quot;#5fc9f8&quot;</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">ListModel</span> <span class="p">{</span>
        <span class="kd">id: theModel</span>

        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">number:</span> <span class="mi">0</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">number:</span> <span class="mi">1</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">number:</span> <span class="mi">2</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">number:</span> <span class="mi">3</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">number:</span> <span class="mi">4</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">number:</span> <span class="mi">5</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">number:</span> <span class="mi">6</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">number:</span> <span class="mi">7</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">number:</span> <span class="mi">8</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">number:</span> <span class="mi">9</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">Rectangle</span> <span class="p">{</span>
        <span class="k">anchors.left:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">left</span>
        <span class="k">anchors.right:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">right</span>
        <span class="k">anchors.bottom:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">bottom</span>
        <span class="k">anchors.margins:</span> <span class="mi">20</span>

        <span class="k">height:</span> <span class="mi">40</span>

        <span class="k">color:</span> <span class="s2">&quot;#53d769&quot;</span>
        <span class="k">border.color:</span> <span class="nx">Qt</span><span class="p">.</span><span class="nx">lighter</span><span class="p">(</span><span class="nx">color</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

        <span class="nx">Text</span> <span class="p">{</span>
            <span class="k">anchors.centerIn:</span> <span class="nx">parent</span>

            <span class="k">text:</span> <span class="s2">&quot;Add item!&quot;</span>
        <span class="p">}</span>

        <span class="nx">MouseArea</span> <span class="p">{</span>
            <span class="k">anchors.fill:</span> <span class="nx">parent</span>

            <span class="k">onClicked:</span> <span class="p">{</span>
                <span class="nx">theModel</span><span class="p">.</span><span class="nx">append</span><span class="p">({</span><span class="s2">&quot;number&quot;</span><span class="o">:</span> <span class="o">++</span><span class="nx">parent</span><span class="p">.</span><span class="nx">count</span><span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">property</span> <span class="kr">int</span> <span class="k">count:</span> <span class="mi">9</span>
    <span class="p">}</span>

    <span class="nx">GridView</span> <span class="p">{</span>
        <span class="k">anchors.fill:</span> <span class="nx">parent</span>
        <span class="k">anchors.margins:</span> <span class="mi">20</span>
        <span class="k">anchors.bottomMargin:</span> <span class="mi">80</span>

        <span class="k">clip:</span> <span class="kc">true</span>

        <span class="k">model:</span> <span class="nx">theModel</span>

        <span class="k">cellWidth:</span> <span class="mi">45</span>
        <span class="k">cellHeight:</span> <span class="mi">45</span>

        <span class="k">delegate:</span> <span class="nx">numberDelegate</span>
    <span class="p">}</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: numberDelegate</span>

        <span class="nx">Rectangle</span> <span class="p">{</span>
            <span class="kd">id: wrapper</span>

            <span class="k">width:</span> <span class="mi">40</span>
            <span class="k">height:</span> <span class="mi">40</span>

            <span class="k">gradient:</span> <span class="nx">Gradient</span> <span class="p">{</span>
                <span class="nx">GradientStop</span> <span class="p">{</span> <span class="k">position:</span> <span class="mf">0.0</span><span class="p">;</span> <span class="k">color:</span> <span class="s2">&quot;#f8306a&quot;</span> <span class="p">}</span>
                <span class="nx">GradientStop</span> <span class="p">{</span> <span class="k">position:</span> <span class="mf">1.0</span><span class="p">;</span> <span class="k">color:</span> <span class="s2">&quot;#fb5b40&quot;</span> <span class="p">}</span>
            <span class="p">}</span>

            <span class="nx">Text</span> <span class="p">{</span>
                <span class="k">anchors.centerIn:</span> <span class="nx">parent</span>

                <span class="k">font.pixelSize:</span> <span class="mi">10</span>

                <span class="k">text:</span> <span class="nx">number</span>
            <span class="p">}</span>

            <span class="nx">MouseArea</span> <span class="p">{</span>
                <span class="k">anchors.fill:</span> <span class="nx">parent</span>

                <span class="k">onClicked:</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">GridView</span><span class="p">.</span><span class="nx">delayRemove</span><span class="p">)</span>
                        <span class="nx">theModel</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">GridView.onRemove:</span> <span class="nx">SequentialAnimation</span> <span class="p">{</span>
                <span class="nx">PropertyAction</span> <span class="p">{</span> <span class="k">target:</span> <span class="nx">wrapper</span><span class="p">;</span> <span class="k">property:</span> <span class="s2">&quot;GridView.delayRemove&quot;</span><span class="p">;</span> <span class="k">value:</span> <span class="kc">true</span> <span class="p">}</span>
                <span class="nx">NumberAnimation</span> <span class="p">{</span> <span class="k">target:</span> <span class="nx">wrapper</span><span class="p">;</span> <span class="k">property:</span> <span class="s2">&quot;scale&quot;</span><span class="p">;</span> <span class="k">to:</span> <span class="mi">0</span><span class="p">;</span> <span class="k">duration:</span> <span class="mi">250</span><span class="p">;</span> <span class="k">easing.type:</span> <span class="nx">Easing</span><span class="p">.</span><span class="nx">InOutQuad</span> <span class="p">}</span>
                <span class="nx">PropertyAction</span> <span class="p">{</span> <span class="k">target:</span> <span class="nx">wrapper</span><span class="p">;</span> <span class="k">property:</span> <span class="s2">&quot;GridView.delayRemove&quot;</span><span class="p">;</span> <span class="k">value:</span> <span class="kc">false</span> <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">GridView.onAdd:</span> <span class="nx">SequentialAnimation</span> <span class="p">{</span>
                <span class="nx">NumberAnimation</span> <span class="p">{</span> <span class="k">target:</span> <span class="nx">wrapper</span><span class="p">;</span> <span class="k">property:</span> <span class="s2">&quot;scale&quot;</span><span class="p">;</span> <span class="k">from:</span> <span class="mi">0</span><span class="p">;</span> <span class="k">to:</span> <span class="mi">1</span><span class="p">;</span> <span class="k">duration:</span> <span class="mi">250</span><span class="p">;</span> <span class="k">easing.type:</span> <span class="nx">Easing</span><span class="p">.</span><span class="nx">InOutQuad</span> <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="shape-shifting-delegates">
<h3>6.4.2. Shape-Shifting Delegates<a class="headerlink" href="#shape-shifting-delegates" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23shape-shifting-delegates&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>A commonly used mechanism in lists is that the current item is expanded when activated. This can be used to dynamically let the item expand to fill the screen to enter a new part of the user interface, or it can be used to provide slightly more information for the current item in a given list.</p>
<p>In the example below, each item is expanded to the full extent of the <tt class="docutils literal"><span class="pre">ListView</span></tt> containing it when clicked. The extra spaced is then used to add more information. The mechanism used to control this is a state, <tt class="docutils literal"><span class="pre">expanded</span></tt> that each item delegate can enter, where the item is expanded. In that state, a number of properties are altered.</p>
<p>First of all, the <tt class="docutils literal"><span class="pre">height</span></tt> of the <tt class="docutils literal"><span class="pre">wrapper</span></tt> is set to the height of the <tt class="docutils literal"><span class="pre">ListView</span></tt>. The thumbnail image is then enlarged and moved down to make it move from its small position into its larger position. In addition to this, the two hidden items, the <tt class="docutils literal"><span class="pre">factsView</span></tt> and <tt class="docutils literal"><span class="pre">closeButton</span></tt> are shown by altering the <tt class="docutils literal"><span class="pre">opacity</span></tt> of the elements. Finally, the <tt class="docutils literal"><span class="pre">ListView</span></tt> is setup.</p>
<p>Setting up the <tt class="docutils literal"><span class="pre">ListView</span></tt> involves setting the <tt class="docutils literal"><span class="pre">contentsY</span></tt>, that is the top of the visible part of the view, to the <tt class="docutils literal"><span class="pre">y</span></tt> value of the delegate. The other change is to set <tt class="docutils literal"><span class="pre">interactive</span></tt> of the view to <tt class="docutils literal"><span class="pre">false</span></tt>. This prevents the view from moving. The user can no longer scroll through the list or change the current item.</p>
<p>As the item first is clicked, it enters the <tt class="docutils literal"><span class="pre">expanded</span></tt> state, causing the item delegate to fill the <tt class="docutils literal"><span class="pre">ListView</span></tt> and the contents to rearrange. When the close button is clicked, the state is cleared, causing the delegate to return to its previous state and re-enabling the <tt class="docutils literal"><span class="pre">ListView</span></tt>.</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>

<span class="nx">Item</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">300</span>
    <span class="k">height:</span> <span class="mi">480</span>

    <span class="nx">Rectangle</span> <span class="p">{</span>
        <span class="k">anchors.fill:</span> <span class="nx">parent</span>
        <span class="k">gradient:</span> <span class="nx">Gradient</span> <span class="p">{</span>
            <span class="nx">GradientStop</span> <span class="p">{</span> <span class="k">position:</span> <span class="mf">0.0</span><span class="p">;</span> <span class="k">color:</span> <span class="s2">&quot;#4a4a4a&quot;</span> <span class="p">}</span>
            <span class="nx">GradientStop</span> <span class="p">{</span> <span class="k">position:</span> <span class="mf">1.0</span><span class="p">;</span> <span class="k">color:</span> <span class="s2">&quot;#2b2b2b&quot;</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">ListView</span> <span class="p">{</span>
        <span class="kd">id: listView</span>

        <span class="k">anchors.fill:</span> <span class="nx">parent</span>

        <span class="k">delegate:</span> <span class="nx">detailsDelegate</span>
        <span class="k">model:</span> <span class="nx">planets</span>
    <span class="p">}</span>

    <span class="nx">ListModel</span> <span class="p">{</span>
        <span class="kd">id: planets</span>

        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Mercury&quot;</span><span class="p">;</span> <span class="k">imageSource:</span> <span class="s2">&quot;images/mercury.jpeg&quot;</span><span class="p">;</span> <span class="k">facts:</span> <span class="s2">&quot;Mercury is the smallest planet in the Solar System. It is the closest planet to the sun. It makes one trip around the Sun once every 87.969 days.&quot;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Venus&quot;</span><span class="p">;</span> <span class="k">imageSource:</span> <span class="s2">&quot;images/venus.jpeg&quot;</span><span class="p">;</span> <span class="k">facts:</span> <span class="s2">&quot;Venus is the second planet from the Sun. It is a terrestrial planet because it has a solid, rocky surface. The other terrestrial planets are Mercury, Earth and Mars. Astronomers have known Venus for thousands of years.&quot;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Earth&quot;</span><span class="p">;</span> <span class="k">imageSource:</span> <span class="s2">&quot;images/earth.jpeg&quot;</span><span class="p">;</span> <span class="k">facts:</span> <span class="s2">&quot;The Earth is the third planet from the Sun. It is one of the four terrestrial planets in our Solar System. This means most of its mass is solid. The other three are Mercury, Venus and Mars. The Earth is also called the Blue Planet, &#39;Planet Earth&#39;, and &#39;Terra&#39;.&quot;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Mars&quot;</span><span class="p">;</span> <span class="k">imageSource:</span> <span class="s2">&quot;images/mars.jpeg&quot;</span><span class="p">;</span> <span class="k">facts:</span> <span class="s2">&quot;Mars is the fourth planet from the Sun in the Solar System. Mars is dry, rocky and cold. It is home to the largest volcano in the Solar System. Mars is named after the mythological Roman god of war because it is a red planet, which signifies the colour of blood.&quot;</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: detailsDelegate</span>

        <span class="nx">Item</span> <span class="p">{</span>
            <span class="kd">id: wrapper</span>

            <span class="k">width:</span> <span class="nx">listView</span><span class="p">.</span><span class="nx">width</span>
            <span class="k">height:</span> <span class="mi">30</span>

            <span class="nx">Rectangle</span> <span class="p">{</span>
                <span class="k">anchors.left:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">left</span>
                <span class="k">anchors.right:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">right</span>
                <span class="k">anchors.top:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">top</span>

                <span class="k">height:</span> <span class="mi">30</span>

                <span class="k">color:</span> <span class="s2">&quot;#333&quot;</span>
                <span class="k">border.color:</span> <span class="nx">Qt</span><span class="p">.</span><span class="nx">lighter</span><span class="p">(</span><span class="nx">color</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
                <span class="nx">Text</span> <span class="p">{</span>
                    <span class="k">anchors.left:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">left</span>
                    <span class="k">anchors.verticalCenter:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">verticalCenter</span>
                    <span class="k">anchors.leftMargin:</span> <span class="mi">4</span>

                    <span class="k">font.pixelSize:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">height</span><span class="o">-</span><span class="mi">4</span>
                    <span class="k">color:</span> <span class="s1">&#39;#fff&#39;</span>

                    <span class="k">text:</span> <span class="nx">name</span>
                <span class="p">}</span>
            <span class="p">}</span>


            <span class="nx">Rectangle</span> <span class="p">{</span>
                <span class="kd">id: image</span>

                <span class="k">width:</span> <span class="mi">26</span>
                <span class="k">height:</span> <span class="mi">26</span>

                <span class="k">anchors.right:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">right</span>
                <span class="k">anchors.top:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">top</span>
                <span class="k">anchors.rightMargin:</span> <span class="mi">2</span>
                <span class="k">anchors.topMargin:</span> <span class="mi">2</span>

                <span class="k">color:</span> <span class="s2">&quot;black&quot;</span>


                <span class="nx">Image</span> <span class="p">{</span>
                    <span class="k">anchors.fill:</span> <span class="nx">parent</span>

                    <span class="k">fillMode:</span> <span class="nx">Image</span><span class="p">.</span><span class="nx">PreserveAspectFit</span>

                    <span class="k">source:</span> <span class="nx">imageSource</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="nx">MouseArea</span> <span class="p">{</span>
                <span class="k">anchors.fill:</span> <span class="nx">parent</span>
                <span class="k">onClicked:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="s2">&quot;expanded&quot;</span>
            <span class="p">}</span>

            <span class="nx">Item</span> <span class="p">{</span>
                <span class="kd">id: factsView</span>

                <span class="k">anchors.top:</span> <span class="nx">image</span><span class="p">.</span><span class="nx">bottom</span>
                <span class="k">anchors.left:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">left</span>
                <span class="k">anchors.right:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">right</span>
                <span class="k">anchors.bottom:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">bottom</span>

                <span class="k">opacity:</span> <span class="mi">0</span>

                <span class="nx">Rectangle</span> <span class="p">{</span>
                    <span class="k">anchors.fill:</span> <span class="nx">parent</span>

                    <span class="k">gradient:</span> <span class="nx">Gradient</span> <span class="p">{</span>
                        <span class="nx">GradientStop</span> <span class="p">{</span> <span class="k">position:</span> <span class="mf">0.0</span><span class="p">;</span> <span class="k">color:</span> <span class="s2">&quot;#fed958&quot;</span> <span class="p">}</span>
                        <span class="nx">GradientStop</span> <span class="p">{</span> <span class="k">position:</span> <span class="mf">1.0</span><span class="p">;</span> <span class="k">color:</span> <span class="s2">&quot;#fecc2f&quot;</span> <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="k">border.color:</span> <span class="s1">&#39;#000000&#39;</span>
                    <span class="k">border.width:</span> <span class="mi">2</span>

                    <span class="nx">Text</span> <span class="p">{</span>
                        <span class="k">anchors.fill:</span> <span class="nx">parent</span>
                        <span class="k">anchors.margins:</span> <span class="mi">5</span>

                        <span class="k">clip:</span> <span class="kc">true</span>
                        <span class="k">wrapMode:</span> <span class="nx">Text</span><span class="p">.</span><span class="nx">WordWrap</span>
                        <span class="k">color:</span> <span class="s1">&#39;#1f1f21&#39;</span>

                        <span class="k">font.pixelSize:</span> <span class="mi">12</span>

                        <span class="k">text:</span> <span class="nx">facts</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="nx">Rectangle</span> <span class="p">{</span>
                <span class="kd">id: closeButton</span>

                <span class="k">anchors.right:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">right</span>
                <span class="k">anchors.top:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">top</span>
                <span class="k">anchors.rightMargin:</span> <span class="mi">2</span>
                <span class="k">anchors.topMargin:</span> <span class="mi">2</span>

                <span class="k">width:</span> <span class="mi">26</span>
                <span class="k">height:</span> <span class="mi">26</span>

                <span class="k">color:</span> <span class="s2">&quot;#157efb&quot;</span>
                <span class="k">border.color:</span> <span class="nx">Qt</span><span class="p">.</span><span class="nx">lighter</span><span class="p">(</span><span class="nx">color</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

                <span class="k">opacity:</span> <span class="mi">0</span>

                <span class="nx">MouseArea</span> <span class="p">{</span>
                    <span class="k">anchors.fill:</span> <span class="nx">parent</span>
                    <span class="k">onClicked:</span> <span class="nx">wrapper</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">states:</span> <span class="p">[</span>
                <span class="nx">State</span> <span class="p">{</span>
                    <span class="k">name:</span> <span class="s2">&quot;expanded&quot;</span>

                    <span class="nx">PropertyChanges</span> <span class="p">{</span> <span class="k">target:</span> <span class="nx">wrapper</span><span class="p">;</span> <span class="k">height:</span> <span class="nx">listView</span><span class="p">.</span><span class="nx">height</span> <span class="p">}</span>
                    <span class="nx">PropertyChanges</span> <span class="p">{</span> <span class="k">target:</span> <span class="nx">image</span><span class="p">;</span> <span class="k">width:</span> <span class="nx">listView</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span> <span class="k">height:</span> <span class="nx">listView</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span> <span class="k">anchors.rightMargin:</span> <span class="mi">0</span><span class="p">;</span> <span class="k">anchors.topMargin:</span> <span class="mi">30</span> <span class="p">}</span>
                    <span class="nx">PropertyChanges</span> <span class="p">{</span> <span class="k">target:</span> <span class="nx">factsView</span><span class="p">;</span> <span class="k">opacity:</span> <span class="mi">1</span> <span class="p">}</span>
                    <span class="nx">PropertyChanges</span> <span class="p">{</span> <span class="k">target:</span> <span class="nx">closeButton</span><span class="p">;</span> <span class="k">opacity:</span> <span class="mi">1</span> <span class="p">}</span>
                    <span class="nx">PropertyChanges</span> <span class="p">{</span> <span class="k">target:</span> <span class="nx">wrapper</span><span class="p">.</span><span class="nx">ListView</span><span class="p">.</span><span class="nx">view</span><span class="p">;</span> <span class="k">contentY:</span> <span class="nx">wrapper</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span> <span class="k">interactive:</span> <span class="kc">false</span> <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">]</span>

            <span class="k">transitions:</span> <span class="p">[</span>
                <span class="nx">Transition</span> <span class="p">{</span>
                    <span class="nx">NumberAnimation</span> <span class="p">{</span>
                        <span class="k">duration:</span> <span class="mi">200</span><span class="p">;</span>
                        <span class="k">properties:</span> <span class="s2">&quot;height,width,anchors.rightMargin,anchors.topMargin,opacity,contentY&quot;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<img alt="../../_images/delegates-expanding-small.png" src="../../_images/delegates-expanding-small.png" />
<img alt="../../_images/delegates-expanding-large.png" src="../../_images/delegates-expanding-large.png" />
<p>The techniques demonstrated here to expand the delegate to fill the entire view can be employed to make an item delegate shift shape in a much smaller way. For instance, when browsing through a list of songs, the current item could be made slightly larger, accommodating more information about that particular item.</p>
</div>
</div>
<div class="section" id="advanced-techniques">
<h2>6.5. Advanced Techniques<a class="headerlink" href="#advanced-techniques" title="Permalink to this headline">¶</a></h2>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23advanced-techniques&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><div class="section" id="the-pathview">
<h3>6.5.1. The PathView<a class="headerlink" href="#the-pathview" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23the-pathview&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>The <tt class="docutils literal"><span class="pre">PathView</span></tt> element is the most powerful, but also the most complex, view provided in QtQuick. It makes it possible to create a view where the items are laid out along an arbitrary path. Along the same path, attributes such as scale, opacity and more can be controlled in detail.</p>
<p>When using the <tt class="docutils literal"><span class="pre">PathView</span></tt>, you have to define a delegate and a path. In addition to this, the <tt class="docutils literal"><span class="pre">PathView</span></tt> itself can be customized through a range of properties. The most common being <tt class="docutils literal"><span class="pre">pathItemCount</span></tt>, controlling the number of visible items at once, and the highlight range control properties <tt class="docutils literal"><span class="pre">preferredHighlightBegin</span></tt>, <tt class="docutils literal"><span class="pre">preferredHighlightEnd</span></tt> and <tt class="docutils literal"><span class="pre">highlightRangeMode</span></tt>, controlling where along the path the current item is to be shown.</p>
<p>Before looking at the highlight range control properties in depth, we must look at the <tt class="docutils literal"><span class="pre">path</span></tt> property. The <tt class="docutils literal"><span class="pre">path</span></tt> property expects a <tt class="docutils literal"><span class="pre">Path</span></tt> element defining the path that the delegates follows as the <tt class="docutils literal"><span class="pre">PathView</span></tt> is being scrolled. The path is defined using the <tt class="docutils literal"><span class="pre">startX</span></tt> and <tt class="docutils literal"><span class="pre">startY</span></tt> properties in combinations with path elements such as <tt class="docutils literal"><span class="pre">PathLine</span></tt>, <tt class="docutils literal"><span class="pre">PathQuad</span></tt> and <tt class="docutils literal"><span class="pre">PathCubic</span></tt>.  These elements are joined together to form a two-dimensional path.</p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">do we cover the line, quad and cubic through an illustration, or do we need a paragraph on them?</p>
</div>
<p>When the path has been defined, it is possible to further tune it using <tt class="docutils literal"><span class="pre">PathPercent</span></tt> and <tt class="docutils literal"><span class="pre">PathAttribute</span></tt> elements. These are placed in between path elements and provides a more fine grained control over the path and the delegates on it. The <tt class="docutils literal"><span class="pre">PathPercent</span></tt> controls how large a portion of the path that has been covered between each element. This, in turn, controls the distribution of delegates along the path, as they are distributed proportionally to the percentage progressed.</p>
<p>This is where the <tt class="docutils literal"><span class="pre">preferredHighlightBegin</span></tt> and <tt class="docutils literal"><span class="pre">preferredHighlightEnd</span></tt> properties of the <tt class="docutils literal"><span class="pre">PathView</span></tt> enters the picture. They both expect real values in the range between zero and one. The end is also expected to be more or equal to the beginning. Setting both these properties to, for instance, 0.5, the current item will be displayed at the location fifty percent along the path.</p>
<p>In the <tt class="docutils literal"><span class="pre">Path</span></tt>, the <tt class="docutils literal"><span class="pre">PathAttribute</span></tt> elements are placed between elements, just as <tt class="docutils literal"><span class="pre">PathPercent</span></tt> elements. They let you specify property values that are interpolated along the path. These properties are attached to the delegates and can be used to control any conceivable property.</p>
<img alt="../../_images/pathview-coverview.png" src="../../_images/pathview-coverview.png" />
<p>The example below demonstrates how the <tt class="docutils literal"><span class="pre">PathView</span></tt> element is used to create view of cards that the user can flip through. It employs a number of tricks to do this. The path consists of three <tt class="docutils literal"><span class="pre">PathLine</span></tt> elements. Using <tt class="docutils literal"><span class="pre">PathPercent</span></tt> elements, the central element is properly centered and provided enough space not to be cluttered by other elements. Using <tt class="docutils literal"><span class="pre">PathAttribute</span></tt> elements, the rotation, size and <tt class="docutils literal"><span class="pre">z</span></tt>-value are controlled.</p>
<p>In addition to the <tt class="docutils literal"><span class="pre">path</span></tt>, the <tt class="docutils literal"><span class="pre">pathItemCount</span></tt> property of the <tt class="docutils literal"><span class="pre">PathView</span></tt> has been set. This controls how densely populated the path will be. The <tt class="docutils literal"><span class="pre">preferredHighlightBegin</span></tt> and <tt class="docutils literal"><span class="pre">preferredHighlightEnd</span></tt> the <tt class="docutils literal"><span class="pre">PathView.onPath</span></tt> is used to control the visibility of the delegates.</p>
<div class="highlight-qml"><div class="highlight"><pre>    <span class="nx">PathView</span> <span class="p">{</span>
        <span class="k">anchors.fill:</span> <span class="nx">parent</span>

        <span class="k">delegate:</span> <span class="nx">flipCardDelegate</span>
        <span class="k">model:</span> <span class="mi">100</span>

        <span class="k">path:</span> <span class="nx">Path</span> <span class="p">{</span>
            <span class="k">startX:</span> <span class="nx">root</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="mi">2</span>
            <span class="k">startY:</span> <span class="mi">0</span>

            <span class="nx">PathAttribute</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;itemZ&quot;</span><span class="p">;</span> <span class="k">value:</span> <span class="mi">0</span> <span class="p">}</span>
            <span class="nx">PathAttribute</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;itemAngle&quot;</span><span class="p">;</span> <span class="k">value:</span> <span class="o">-</span><span class="mf">90.0</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">PathAttribute</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;itemScale&quot;</span><span class="p">;</span> <span class="k">value:</span> <span class="mf">0.5</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">PathLine</span> <span class="p">{</span> <span class="k">x:</span> <span class="nx">root</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="k">y:</span> <span class="nx">root</span><span class="p">.</span><span class="nx">height</span><span class="o">*</span><span class="mf">0.4</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">PathPercent</span> <span class="p">{</span> <span class="k">value:</span> <span class="mf">0.48</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">PathLine</span> <span class="p">{</span> <span class="k">x:</span> <span class="nx">root</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="k">y:</span> <span class="nx">root</span><span class="p">.</span><span class="nx">height</span><span class="o">*</span><span class="mf">0.5</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">PathAttribute</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;itemAngle&quot;</span><span class="p">;</span> <span class="k">value:</span> <span class="mf">0.0</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">PathAttribute</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;itemScale&quot;</span><span class="p">;</span> <span class="k">value:</span> <span class="mf">1.0</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">PathAttribute</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;itemZ&quot;</span><span class="p">;</span> <span class="k">value:</span> <span class="mi">100</span> <span class="p">}</span>
            <span class="nx">PathLine</span> <span class="p">{</span> <span class="k">x:</span> <span class="nx">root</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="k">y:</span> <span class="nx">root</span><span class="p">.</span><span class="nx">height</span><span class="o">*</span><span class="mf">0.6</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">PathPercent</span> <span class="p">{</span> <span class="k">value:</span> <span class="mf">0.52</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">PathLine</span> <span class="p">{</span> <span class="k">x:</span> <span class="nx">root</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="k">y:</span> <span class="nx">root</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">PathAttribute</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;itemAngle&quot;</span><span class="p">;</span> <span class="k">value:</span> <span class="mf">90.0</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">PathAttribute</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;itemScale&quot;</span><span class="p">;</span> <span class="k">value:</span> <span class="mf">0.5</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">PathAttribute</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;itemZ&quot;</span><span class="p">;</span> <span class="k">value:</span> <span class="mi">0</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">pathItemCount:</span> <span class="mi">16</span>

        <span class="k">preferredHighlightBegin:</span> <span class="mf">0.5</span>
        <span class="k">preferredHighlightEnd:</span> <span class="mf">0.5</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>The delegate, shown below, utilizes the attached properties <tt class="docutils literal"><span class="pre">itemZ</span></tt>, <tt class="docutils literal"><span class="pre">itemAngle</span></tt> and <tt class="docutils literal"><span class="pre">itemScale</span></tt> from the <tt class="docutils literal"><span class="pre">PathAttribute</span></tt> elements. It is worth noticing that the attached properties of the delegate only are available from the <tt class="docutils literal"><span class="pre">wrapper</span></tt>. Thus, the <tt class="docutils literal"><span class="pre">rotX</span></tt> property is defined to be able to access the value from within the <tt class="docutils literal"><span class="pre">Rotation</span></tt> element.</p>
<p>Another detail specific to <tt class="docutils literal"><span class="pre">PathView</span></tt> worth noticing is the usage of the attached <tt class="docutils literal"><span class="pre">PathView.onPath</span></tt> property. It is common practice to bind the visibility to this, as this allows the <tt class="docutils literal"><span class="pre">PathView</span></tt> to keep invisible elements for caching purposes. This can usually not be handled through clipping, as the item delegates of a <tt class="docutils literal"><span class="pre">PathView</span></tt> are placed more freely than the item delegates of <tt class="docutils literal"><span class="pre">ListView</span></tt> or <tt class="docutils literal"><span class="pre">GridView</span></tt> views.</p>
<div class="highlight-qml"><div class="highlight"><pre>    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: flipCardDelegate</span>

        <span class="nx">BlueBox</span> <span class="p">{</span>
            <span class="kd">id: wrapper</span>

            <span class="k">width:</span> <span class="mi">64</span>
            <span class="k">height:</span> <span class="mi">64</span>
            <span class="k">antialiasing:</span> <span class="kc">true</span>

            <span class="k">gradient:</span> <span class="nx">Gradient</span> <span class="p">{</span>
                <span class="nx">GradientStop</span> <span class="p">{</span> <span class="k">position:</span> <span class="mf">0.0</span><span class="p">;</span> <span class="k">color:</span> <span class="s2">&quot;#2ed5fa&quot;</span> <span class="p">}</span>
                <span class="nx">GradientStop</span> <span class="p">{</span> <span class="k">position:</span> <span class="mf">1.0</span><span class="p">;</span> <span class="k">color:</span> <span class="s2">&quot;#2467ec&quot;</span> <span class="p">}</span>
            <span class="p">}</span>


            <span class="k">visible:</span> <span class="nx">PathView</span><span class="p">.</span><span class="nx">onPath</span>

            <span class="k">scale:</span> <span class="nx">PathView</span><span class="p">.</span><span class="nx">itemScale</span>
            <span class="k">z:</span> <span class="nx">PathView</span><span class="p">.</span><span class="nx">itemZ</span>

            <span class="nx">property</span> <span class="nx">variant</span> <span class="k">rotX:</span> <span class="nx">PathView</span><span class="p">.</span><span class="nx">itemAngle</span>
            <span class="k">transform:</span> <span class="nx">Rotation</span> <span class="p">{</span>
                <span class="nx">axis</span> <span class="p">{</span> <span class="k">x:</span> <span class="mi">1</span><span class="p">;</span> <span class="k">y:</span> <span class="mi">0</span><span class="p">;</span> <span class="k">z:</span> <span class="mi">0</span> <span class="p">}</span>
                <span class="k">angle:</span> <span class="nx">wrapper</span><span class="p">.</span><span class="nx">rotX</span><span class="p">;</span>
                <span class="nx">origin</span> <span class="p">{</span> <span class="k">x:</span> <span class="mi">32</span><span class="p">;</span> <span class="k">y:</span> <span class="mi">32</span><span class="p">;</span> <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">text:</span> <span class="nx">index</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>When transforming images or other complex elements on in <tt class="docutils literal"><span class="pre">PathView</span></tt>, a performance optimization trick that is common to use is to bind the <tt class="docutils literal"><span class="pre">smooth</span></tt> property of the <tt class="docutils literal"><span class="pre">Image</span></tt> element to the attached property <tt class="docutils literal"><span class="pre">PathView.view.moving</span></tt>. This means that the images are less pretty while moving, but smoothly transformed when stationary. There is no point spending processing power on smooth scaling when the view is in motion, as the user will not be able to see this anyway.</p>
</div>
<div class="section" id="a-model-from-xml">
<h3>6.5.2. A Model from XML<a class="headerlink" href="#a-model-from-xml" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23a-model-from-xml&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>As XML is an ubiquitous data format, QML provides the <tt class="docutils literal"><span class="pre">XmlListModel</span></tt> element that exposes XML data as a model. The element can fetch XML data locally or remotely and then processes the data using XPath expressions.</p>
<p>The example below demonstrates fetching images from an RSS flow. The <tt class="docutils literal"><span class="pre">source</span></tt> property refers to a remove location over HTTP, and the data is automatically downloaded.</p>
<img alt="../../_images/xmllistmodel-images.png" src="../../_images/xmllistmodel-images.png" />
<p>When the data has been downloaded, it is processed into model items and roles. The <tt class="docutils literal"><span class="pre">query</span></tt> property is an XPath representing the base query for creating model items. In this example, the path is <tt class="docutils literal"><span class="pre">/rss/channel/item</span></tt>, so for every item tag, inside a channel tag, inside an RSS tag, a model item is created.</p>
<p>For every model item, a number of roles are extracted. These are represented by <tt class="docutils literal"><span class="pre">XmlRole</span></tt> elements. Each role is given a name, which the delegate can access through an attached property. The actual value of each such property is determined through the XPath query for each role. For instance, the <tt class="docutils literal"><span class="pre">title</span></tt> property corresponds to the <tt class="docutils literal"><span class="pre">title/string()</span></tt> query, returning the contents between the <tt class="docutils literal"><span class="pre">&lt;title&gt;</span></tt> and <tt class="docutils literal"><span class="pre">&lt;/title&gt;</span></tt> tags.</p>
<p>The <tt class="docutils literal"><span class="pre">imageSource</span></tt> property is more interesting as it not only extracts a string from the XML, but also processes it. In the stream provided, every item contains an image, represented by an <tt class="docutils literal"><span class="pre">&lt;img</span> <span class="pre">src=</span></tt> tag. Using the <tt class="docutils literal"><span class="pre">substring-after</span></tt> and <tt class="docutils literal"><span class="pre">substring-before</span></tt> XPath functions, the location of the image is extracted and returned. Thus the <tt class="docutils literal"><span class="pre">imageSource</span></tt> property can be used directly as the <tt class="docutils literal"><span class="pre">source</span></tt> for an <tt class="docutils literal"><span class="pre">Image</span></tt> element.</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>
<span class="kr">import</span> <span class="nx">QtQuick</span><span class="p">.</span><span class="nx">XmlListModel</span> <span class="mf">2.0</span>
<span class="kr">import</span> <span class="s2">&quot;../common&quot;</span>

<span class="nx">Background</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">300</span>
    <span class="k">height:</span> <span class="mi">480</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: imageDelegate</span>

        <span class="nx">Box</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="nx">listView</span><span class="p">.</span><span class="nx">width</span>
            <span class="k">height:</span> <span class="mi">220</span>
            <span class="k">color:</span> <span class="s1">&#39;#333&#39;</span>

            <span class="nx">Column</span> <span class="p">{</span>
                <span class="nx">Text</span> <span class="p">{</span>
                    <span class="k">text:</span> <span class="nx">title</span>
                    <span class="k">color:</span> <span class="s1">&#39;#e0e0e0&#39;</span>
                <span class="p">}</span>
                <span class="nx">Image</span> <span class="p">{</span>
                    <span class="k">width:</span> <span class="nx">listView</span><span class="p">.</span><span class="nx">width</span>
                    <span class="k">height:</span> <span class="mi">200</span>
                    <span class="k">fillMode:</span> <span class="nx">Image</span><span class="p">.</span><span class="nx">PreserveAspectCrop</span>
                    <span class="k">source:</span> <span class="nx">imageSource</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">XmlListModel</span> <span class="p">{</span>
        <span class="kd">id: imageModel</span>

        <span class="k">source:</span> <span class="s2">&quot;http://feeds.nationalgeographic.com/ng/photography/photo-of-the-day/&quot;</span>
        <span class="k">query:</span> <span class="s2">&quot;/rss/channel/item&quot;</span>

        <span class="nx">XmlRole</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;title&quot;</span><span class="p">;</span> <span class="k">query:</span> <span class="s2">&quot;title/string()&quot;</span> <span class="p">}</span>
        <span class="nx">XmlRole</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;imageSource&quot;</span><span class="p">;</span> <span class="k">query:</span> <span class="s2">&quot;substring-before(substring-after(description/string(), &#39;img src=\&quot;&#39;), &#39;\&quot;&#39;)&quot;</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">ListView</span> <span class="p">{</span>
        <span class="kd">id: listView</span>
        <span class="k">anchors.fill:</span> <span class="nx">parent</span>
        <span class="k">model:</span> <span class="nx">imageModel</span>
        <span class="k">delegate:</span> <span class="nx">imageDelegate</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="lists-with-sections">
<h3>6.5.3. Lists with Sections<a class="headerlink" href="#lists-with-sections" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23lists-with-sections&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>Sometimes, the data in a list can be divided into sections. It can be as simple as dividing a list of contacts into sections under each letter of the alphabet or music tracks under albums. Using a <tt class="docutils literal"><span class="pre">ListView</span></tt> it is possible to divide a flat list into categories, providing more depth to the experience.</p>
<img alt="../../_images/listview-sections.png" src="../../_images/listview-sections.png" />
<p>In order to use sections, the <tt class="docutils literal"><span class="pre">section.property</span></tt> and <tt class="docutils literal"><span class="pre">section.criteria</span></tt> must be setup. The <tt class="docutils literal"><span class="pre">section.property</span></tt> defines which property to use to divide the contents into sections. Here, it is important to know that the model must be sorted so that each section consists of continuous elements, otherwise, the same property name might appear in multiple locations.</p>
<p>The <tt class="docutils literal"><span class="pre">section.criteria</span></tt> can be set to either <tt class="docutils literal"><span class="pre">ViewSection.FullString</span></tt> or <tt class="docutils literal"><span class="pre">ViewSection.FirstCharacter</span></tt>. The first is the default value and can be used for models that have clear sections, for example tracks of music albums. The latter takes the first character of a property and means that any property can be used for this. The most common example being the last name of contacts in a phone book.</p>
<p>When the sections have been defined, they can be accessed from each item using the attached properties <tt class="docutils literal"><span class="pre">ListView.section</span></tt>, <tt class="docutils literal"><span class="pre">ListView.previousSection</span></tt> and <tt class="docutils literal"><span class="pre">ListView.nextSection</span></tt>. Using these properties, it is possible to detect the first and last item of a section and act accordingly.</p>
<p>It is also possible to assign a section delegate component to the <tt class="docutils literal"><span class="pre">section.delegate</span></tt> property of a <tt class="docutils literal"><span class="pre">ListView</span></tt>. This creates a section header delegate which is inserted before any items of a section. The delegate component can access the name of the current section using the attached property <tt class="docutils literal"><span class="pre">section</span></tt>.</p>
<p>The example below demonstrates the section concept by showing a list of space men sectioned after their nationality. The <tt class="docutils literal"><span class="pre">nation</span></tt> is used as the <tt class="docutils literal"><span class="pre">section.property</span></tt>. The <tt class="docutils literal"><span class="pre">section.delegate</span></tt> component, <tt class="docutils literal"><span class="pre">sectionDelegate</span></tt>, shows a heading for each nation, displaying the name of the nation. In each section, the names of the space men are shown using the <tt class="docutils literal"><span class="pre">spaceManDelegate</span></tt> component.</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>
<span class="kr">import</span> <span class="s2">&quot;../common&quot;</span>

<span class="nx">Background</span> <span class="p">{</span>
    <span class="k">width:</span> <span class="mi">300</span>
    <span class="k">height:</span> <span class="mi">290</span>

    <span class="nx">ListView</span> <span class="p">{</span>
        <span class="k">anchors.fill:</span> <span class="nx">parent</span>
        <span class="k">anchors.margins:</span> <span class="mi">20</span>

        <span class="k">clip:</span> <span class="kc">true</span>

        <span class="k">model:</span> <span class="nx">spaceMen</span>

        <span class="k">delegate:</span> <span class="nx">spaceManDelegate</span>

        <span class="k">section.property:</span> <span class="s2">&quot;nation&quot;</span>
        <span class="k">section.delegate:</span> <span class="nx">sectionDelegate</span>
    <span class="p">}</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: spaceManDelegate</span>

        <span class="nx">Item</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">width</span>
            <span class="k">height:</span> <span class="mi">20</span>
            <span class="nx">Text</span> <span class="p">{</span>
                <span class="k">anchors.left:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">left</span>
                <span class="k">anchors.verticalCenter:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">verticalCenter</span>
                <span class="k">anchors.leftMargin:</span> <span class="mi">8</span>
                <span class="k">font.pixelSize:</span> <span class="mi">12</span>
                <span class="k">text:</span> <span class="nx">name</span>
                <span class="k">color:</span> <span class="s1">&#39;#1f1f1f&#39;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">Component</span> <span class="p">{</span>
        <span class="kd">id: sectionDelegate</span>

        <span class="nx">BlueBox</span> <span class="p">{</span>
            <span class="k">width:</span> <span class="nx">ListView</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">width</span>
            <span class="k">height:</span> <span class="mi">20</span>
            <span class="k">text:</span> <span class="nx">section</span>
            <span class="k">fontColor:</span> <span class="s1">&#39;#e0e0e0&#39;</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="nx">ListModel</span> <span class="p">{</span>
        <span class="kd">id: spaceMen</span>

        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Abdul Ahad Mohmand&quot;</span><span class="p">;</span> <span class="k">nation:</span> <span class="s2">&quot;Afganistan&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Marcos Pontes&quot;</span><span class="p">;</span> <span class="k">nation:</span> <span class="s2">&quot;Brazil&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Alexandar Panayotov Alexandrov&quot;</span><span class="p">;</span> <span class="k">nation:</span> <span class="s2">&quot;Bulgaria&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Georgi Ivanov&quot;</span><span class="p">;</span> <span class="k">nation:</span> <span class="s2">&quot;Bulgaria&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Roberta Bondar&quot;</span><span class="p">;</span> <span class="k">nation:</span> <span class="s2">&quot;Canada&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Marc Garneau&quot;</span><span class="p">;</span> <span class="k">nation:</span> <span class="s2">&quot;Canada&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Chris Hadfield&quot;</span><span class="p">;</span> <span class="k">nation:</span> <span class="s2">&quot;Canada&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Guy Laliberte&quot;</span><span class="p">;</span> <span class="k">nation:</span> <span class="s2">&quot;Canada&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Steven MacLean&quot;</span><span class="p">;</span> <span class="k">nation:</span> <span class="s2">&quot;Canada&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Julie Payette&quot;</span><span class="p">;</span> <span class="k">nation:</span> <span class="s2">&quot;Canada&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Robert Thirsk&quot;</span><span class="p">;</span> <span class="k">nation:</span> <span class="s2">&quot;Canada&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Bjarni Tryggvason&quot;</span><span class="p">;</span> <span class="k">nation:</span> <span class="s2">&quot;Canada&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">ListElement</span> <span class="p">{</span> <span class="k">name:</span> <span class="s2">&quot;Dafydd Williams&quot;</span><span class="p">;</span> <span class="k">nation:</span> <span class="s2">&quot;Canada&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="tuning-performance">
<h3>6.5.4. Tuning Performance<a class="headerlink" href="#tuning-performance" title="Permalink to this headline">¶</a></h3>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23tuning-performance&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>The perceived performance of a view of a model depends very much on the time needed to prepare new delegates. For instance, when scrolling downwards through a ListView, delegates are added just outside the view on the bottom and are removed just as they leave sight over the top of the view. This becomes apparent if the <tt class="docutils literal"><span class="pre">clip</span></tt> property is set to <tt class="docutils literal"><span class="pre">false</span></tt>. If the delegates takes too much time to initialize, it will become apparent for the user as soon as the view is scrolled too quickly.</p>
<p>To work around this issue you can tune the, the margins, in pixels, on the sides of a scrolling view. This is done using the <tt class="docutils literal"><span class="pre">cacheBuffer</span></tt> property. In the case described above, vertical scrolling, it will control how many pixels above and below the ListView that will contain prepared delegates. Combining this with asynchronously loading <tt class="docutils literal"><span class="pre">Image</span></tt> elements can, for instance, give the images time to load before they are brought into view.</p>
<p>Having more delegates sacrifices memory for a smoother experience and slightly more time to initialize each delegate. This does not solve the problem of complex delegates. Each time a delegate is instantiated, its contents is evaluated and compiled. This takes time, and if it takes too much time, it will lead to a poor scrolling experience. Having many elements in a delegate will also degrade the scrolling performance. It simply costs cycles to move many elements.</p>
<p>To remedy the two later issues, it is recommended to use <tt class="docutils literal"><span class="pre">Loader</span></tt> elements. These can be used to instantiate additional elements when they are needed. For instance, an expanding delegate may use a <tt class="docutils literal"><span class="pre">Loader</span></tt> to postpone the instantiation of its detailed view until it is needed. For the same reason, it is good to keep the amount of JavaScript to a minimum in each delegate. It is better to let them call complex pieced of JavaScript that reside outside each delegate. This reduces the time spent compiling JavaScript each time a delegate is created.</p>
</div>
</div>
<div class="section" id="summary">
<h2>6.6. Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<div class="admonition issues">Issues: <a href="https://github.com/qmlbook/qmlbook/issues/new?body=back-link%3A+en%2Fch06%2Findex.html%23summary&labels=ch06">Create</a> | <a href="https://github.com/qmlbook/qmlbook/issues?labels=ch06&page=1&state=open">View</a></div><p>In this chapter, we have looked at models, views and delegates. For each data entry in a model, a view instantiates a delegate visualizing the data. This separates the data from the presentation.</p>
<p>A model can be a single integer, where the <tt class="docutils literal"><span class="pre">index</span></tt> variable is provided to the delegate. If a JavaScript array is used as model, the <tt class="docutils literal"><span class="pre">modelData</span></tt> variable represents the data of the current index of the array, while <tt class="docutils literal"><span class="pre">index</span></tt> holds the index. For more complex cases, where multiple values needs to be provided by each data item, a <tt class="docutils literal"><span class="pre">ListModel</span></tt> populated with <tt class="docutils literal"><span class="pre">ListElement</span></tt> items is a better solution.</p>
<p>For static models, a <tt class="docutils literal"><span class="pre">Repeater</span></tt> can be used as the view. It is easy to combine it with a positioner such as <tt class="docutils literal"><span class="pre">Row</span></tt>, <tt class="docutils literal"><span class="pre">Column</span></tt>, <tt class="docutils literal"><span class="pre">Grid</span></tt> or <tt class="docutils literal"><span class="pre">Flow</span></tt> to build user interface parts. For dynamic or large data models, a view such as <tt class="docutils literal"><span class="pre">ListView</span></tt> or <tt class="docutils literal"><span class="pre">GridView</span></tt> are more appropriate. These create delegate instances on the fly as they are needed, reducing the number of elements live in the scene at once.</p>
<p>The delegates used in the views can be static items with properties bound to data from the model, or they can be dynamic, with states depending on if they are in focus or not. Using the <tt class="docutils literal"><span class="pre">onAdd</span></tt> and <tt class="docutils literal"><span class="pre">onRemove</span></tt> signals of the view, they can even be animated as they appear and disappear.</p>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2012-2014 Jürgen Bocklage-Ryannel and Johan Thelin. This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.<br/>
      Last updated on Mar 15, 2015.<br/>
    </p>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46104829-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>